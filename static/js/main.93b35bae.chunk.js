(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{267:function(e,t,a){e.exports=a.p+"static/media/orbitBanner.13e59aff.png"},268:function(e,t){var a=window.screen.width>768?1*window.screen.width/3:window.screen.width,n={Wrapper:{},Containers:{DefaultStyle:{position:"fixed",width:a,padding:"10px 10px 10px 20px",zIndex:9998,WebkitBoxSizing:"",MozBoxSizing:"",boxSizing:"",height:"auto",display:"inline-block",border:"0",fontSize:"14px",WebkitFontSmoothing:"antialiased",fontFamily:'"Roboto","Helvetica Neue",Arial,sans-serif',fontWeight:"400",color:"#FFFFFF"},tl:{top:"0px",bottom:"auto",left:"0px",right:"auto"},tr:{top:"0px",bottom:"auto",left:"auto",right:"0px"},tc:{top:"0px",bottom:"auto",margin:"0 auto",left:"50%",marginLeft:-a/2},bl:{top:"auto",bottom:"0px",left:"0px",right:"auto"},br:{top:"auto",bottom:"0px",left:"auto",right:"0px"},bc:{top:"auto",bottom:"0px",margin:"0 auto",left:"50%",marginLeft:-a/2}},NotificationItem:{DefaultStyle:{position:"relative",width:"100%",cursor:"pointer",borderRadius:"4px",fontSize:"14px",margin:"10px 0 0",padding:"10px",display:"block",WebkitBoxSizing:"border-box",MozBoxSizing:"border-box",boxSizing:"border-box",opacity:0,transition:"all 0.5s ease-in-out",WebkitTransform:"translate3d(0, 0, 0)",transform:"translate3d(0, 0, 0)",willChange:"transform, opacity",isHidden:{opacity:0},isVisible:{opacity:1}},success:{borderTop:0,backgroundColor:"#a1e82c",WebkitBoxShadow:0,MozBoxShadow:0,boxShadow:0},error:{borderTop:0,backgroundColor:"#fc727a",WebkitBoxShadow:0,MozBoxShadow:0,boxShadow:0},warning:{borderTop:0,backgroundColor:"#ffbc67",WebkitBoxShadow:0,MozBoxShadow:0,boxShadow:0},info:{borderTop:0,backgroundColor:"#63d8f1",WebkitBoxShadow:0,MozBoxShadow:0,boxShadow:0}},Title:{DefaultStyle:{fontSize:"30px",margin:"0",padding:0,fontWeight:"bold",color:"#FFFFFF",display:"block",left:"15px",position:"absolute",top:"50%",marginTop:"-15px"}},MessageWrapper:{DefaultStyle:{marginLeft:"55px",marginRight:"30px",padding:"0 12px 0 0",color:"#FFFFFF",maxWidthwidth:"89%"}},Dismiss:{DefaultStyle:{fontFamily:"inherit",fontSize:"21px",color:"#000",float:"right",position:"absolute",right:"10px",top:"50%",marginTop:"-13px",backgroundColor:"#FFFFFF",display:"block",borderRadius:"50%",opacity:".4",lineHeight:"11px",width:"25px",height:"25px",outline:"0 !important",textAlign:"center",padding:"6px 3px 3px 3px",fontWeight:"300",marginLeft:"65px"},success:{},error:{},warning:{},info:{}},Action:{DefaultStyle:{background:"#ffffff",borderRadius:"2px",padding:"6px 20px",fontWeight:"bold",margin:"10px 0 0 0",border:0},success:{backgroundColor:"#a1e82c",color:"#ffffff"},error:{backgroundColor:"#fc727a",color:"#ffffff"},warning:{backgroundColor:"#ffbc67",color:"#ffffff"},info:{backgroundColor:"#63d8f1",color:"#ffffff"}},ActionWrapper:{DefaultStyle:{margin:0,padding:0}}};e.exports={style:n,thArray:["ID","Name","Salary","Country","City"],tdArray:[["1","Dakota Rice","$36,738","Niger","Oud-Turnhout"],["2","Minerva Hooper","$23,789","Cura\xe7ao","Sinaai-Waas"],["3","Sage Rodriguez","$56,142","Netherlands","Baileux"],["4","Philip Chaney","$38,735","Korea, South","Overland Park"],["5","Doris Greene","$63,542","Malawi","Feldkirchen in K\xe4rnten"],["6","Mason Porter","$78,615","Chile","Gloucester"]],iconsArray:["pe-7s-album","pe-7s-arc","pe-7s-back-2","pe-7s-bandaid","pe-7s-car","pe-7s-diamond","pe-7s-door-lock","pe-7s-eyedropper","pe-7s-female","pe-7s-gym","pe-7s-hammer","pe-7s-headphones","pe-7s-helm","pe-7s-hourglass","pe-7s-leaf","pe-7s-magic-wand","pe-7s-male","pe-7s-map-2","pe-7s-next-2","pe-7s-paint-bucket","pe-7s-pendrive","pe-7s-photo","pe-7s-piggy","pe-7s-plugin","pe-7s-refresh-2","pe-7s-rocket","pe-7s-settings","pe-7s-shield","pe-7s-smile","pe-7s-usb","pe-7s-vector","pe-7s-wine","pe-7s-cloud-upload","pe-7s-cash","pe-7s-close","pe-7s-bluetooth","pe-7s-cloud-download","pe-7s-way","pe-7s-close-circle","pe-7s-id","pe-7s-angle-up","pe-7s-wristwatch","pe-7s-angle-up-circle","pe-7s-world","pe-7s-angle-right","pe-7s-volume","pe-7s-angle-right-circle","pe-7s-users","pe-7s-angle-left","pe-7s-user-female","pe-7s-angle-left-circle","pe-7s-up-arrow","pe-7s-angle-down","pe-7s-switch","pe-7s-angle-down-circle","pe-7s-scissors","pe-7s-wallet","pe-7s-safe","pe-7s-volume2","pe-7s-volume1","pe-7s-voicemail","pe-7s-video","pe-7s-user","pe-7s-upload","pe-7s-unlock","pe-7s-umbrella","pe-7s-trash","pe-7s-tools","pe-7s-timer","pe-7s-ticket","pe-7s-target","pe-7s-sun","pe-7s-study","pe-7s-stopwatch","pe-7s-star","pe-7s-speaker","pe-7s-signal","pe-7s-shuffle","pe-7s-shopbag","pe-7s-share","pe-7s-server","pe-7s-search","pe-7s-film","pe-7s-science","pe-7s-disk","pe-7s-ribbon","pe-7s-repeat","pe-7s-refresh","pe-7s-add-user","pe-7s-refresh-cloud","pe-7s-paperclip","pe-7s-radio","pe-7s-note2","pe-7s-print","pe-7s-network","pe-7s-prev","pe-7s-mute","pe-7s-power","pe-7s-medal","pe-7s-portfolio","pe-7s-like2","pe-7s-plus","pe-7s-left-arrow","pe-7s-play","pe-7s-key","pe-7s-plane","pe-7s-joy","pe-7s-photo-gallery","pe-7s-pin","pe-7s-phone","pe-7s-plug","pe-7s-pen","pe-7s-right-arrow","pe-7s-paper-plane","pe-7s-delete-user","pe-7s-paint","pe-7s-bottom-arrow","pe-7s-notebook","pe-7s-note","pe-7s-next","pe-7s-news-paper","pe-7s-musiclist","pe-7s-music","pe-7s-mouse","pe-7s-more","pe-7s-moon","pe-7s-monitor","pe-7s-micro","pe-7s-menu","pe-7s-map","pe-7s-map-marker","pe-7s-mail","pe-7s-mail-open","pe-7s-mail-open-file","pe-7s-magnet","pe-7s-loop","pe-7s-look","pe-7s-lock","pe-7s-lintern","pe-7s-link","pe-7s-like","pe-7s-light","pe-7s-less","pe-7s-keypad","pe-7s-junk","pe-7s-info","pe-7s-home","pe-7s-help2","pe-7s-help1","pe-7s-graph3","pe-7s-graph2","pe-7s-graph1","pe-7s-graph","pe-7s-global","pe-7s-gleam","pe-7s-glasses","pe-7s-gift","pe-7s-folder","pe-7s-flag","pe-7s-filter","pe-7s-file","pe-7s-expand1","pe-7s-exapnd2","pe-7s-edit","pe-7s-drop","pe-7s-drawer","pe-7s-download","pe-7s-display2","pe-7s-display1","pe-7s-diskette","pe-7s-date","pe-7s-cup","pe-7s-culture","pe-7s-crop","pe-7s-credit","pe-7s-copy-file","pe-7s-config","pe-7s-compass","pe-7s-comment","pe-7s-coffee","pe-7s-cloud","pe-7s-clock","pe-7s-check","pe-7s-chat","pe-7s-cart","pe-7s-camera","pe-7s-call","pe-7s-calculator","pe-7s-browser","pe-7s-box2","pe-7s-box1","pe-7s-bookmarks","pe-7s-bicycle","pe-7s-bell","pe-7s-battery","pe-7s-ball","pe-7s-back","pe-7s-attention","pe-7s-anchor","pe-7s-albums","pe-7s-alarm","pe-7s-airplay"],dataPie:{labels:["40%","20%","40%"],series:[40,20,40]},legendPie:{names:["Open","Bounce","Unsubscribe"],types:["info","danger","warning"]},dataSales:{labels:["9:00AM","12:00AM","3:00PM","6:00PM","9:00PM","12:00PM","3:00AM","6:00AM"],series:[[80,90,100,22,33,44,88,80],[80,88,44,33,0,99,90,80],[22,100,80,90,44,88,80,90]]},optionsSales:{low:0,high:100,showArea:!1,height:"245px",axisX:{showGrid:!1},lineSmooth:!0,showLine:!0,showPoint:!0,fullWidth:!0,chartPadding:{right:50}},responsiveSales:[["screen and (max-width: 640px)",{axisX:{labelInterpolationFnc:function(e){return e[0]}}}]],legendSales:{names:["Tank1","Tank2","Tank3"],types:["info","danger","warning"]},dataBar:{labels:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],series:[[542,443,320,780,553,453,326,434,568,610,756,895],[412,243,280,580,453,353,300,364,368,410,636,695]]},optionsBar:{seriesBarDistance:10,axisX:{showGrid:!1},height:"245px"},responsiveBar:[["screen and (max-width: 640px)",{seriesBarDistance:5,axisX:{labelInterpolationFnc:function(e){return e[0]}}}]],legendBar:{names:["Tesla Model S","BMW 5 Series"],types:["info","danger"]}}},269:function(e,t,a){e.exports=a.p+"static/media/orbitNewLogo2.c3b9401f.png"},270:function(e){e.exports={name:"ntct-tank-monitoring",version:"1.2.0",private:!0,dependencies:{axios:"^0.18.0","d3-color":"^1.2.3","d3-interpolate":"^1.3.2","google-maps-react":"^2.0.2",moment:"^2.22.2","node-sass-chokidar":"^1.3.4","npm-run-all":"^4.1.5",pdfmake:"^0.1.39",react:"^16.6.3","react-bootstrap":"^0.32.4","react-cookie":"^3.0.8","react-data-export":"^0.5.0","react-dates":"^18.3.0","react-dom":"^16.6.3","react-liquid-gauge":"^1.2.4","react-loader-spinner":"^2.3.0","react-router-dom":"^4.3.1","react-scripts":"^2.1.1","react-vis":"^1.11.5",xlsx:"^0.14.1"},homepage:"",main:"index.js",scripts:{deploy:"aws s3 sync build/ s3://goiwater",analyze:"source-map-explorer build/static/js/main.*","build-css":"node-sass-chokidar --include-path ./src --include-path ./node_modules src/ -o src/","watch-css":"npm run build-css && node-sass-chokidar --include-path ./src --include-path ./node_modules src/ -o src/ --watch --recursive","start-js":"react-scripts start",start:"PORT=3006 npm-run-all -p watch-css start-js",build:"npm run build-css && react-scripts build",test:"react-scripts test --env=jsdom",eject:"react-scripts eject"},browserslist:[">0.2%","not dead","not ie <= 11","not op_mini all"]}},272:function(e,t,a){e.exports=a(575)},567:function(e,t,a){},569:function(e,t,a){},571:function(e,t,a){},573:function(e,t,a){},575:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(20),i=a.n(s),l=a(809),o=a(811),c=a(791),u=a(4),d=a(5),m=a(10),p=a(9),h=a(11),g=a(808),f=a(13),v=a(805),k=a(792),y=a(48),b=a(30),E=a.n(b),w="/customers",S="/users",C="/tanklevels";function T(e,t,a){return"https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod"+C+"/"+e+"?from="+t+"&to="+a}function O(){return"https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod"+w}function x(){return"https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod"+S}var j=[],I=function(e,t){var a=new Date,n=(a=("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2))+" "+e.constructor.name+": "+t;j.unshift(n),j.length>500&&j.splice(j.length-1-20,20),console.log(n)},M=[],F=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,[{key:"clearUsers",value:function(){for(;M.length>0;)M.pop()}},{key:"readUsers",value:function(e){var t=this;this.clearUsers();var a=x();E.a.get(a).then(function(a){I(t,"Got users list - "+a.data.length+" "+M.length);for(var n=0;n<a.data.length;n++)M.push(a.data[n]);e&&e()}).catch(function(e){return I(t,e)})}},{key:"getUser",value:function(e){for(var t in M)if(M[t].name===e)return M[t];return null}},{key:"getUsers",value:function(){return M.sort(function(e,t){return e.customer>t.customer?1:0})}},{key:"add",value:function(e,t,a,n,r){var s=this;for(var i in M)if(M[i].name===e)return void(r&&r("user name already exist in the system"));var l={name:e,passwd:t,customer_id:a,role:n},o=x();E.a.post(o,l).then(function(e){I(s,"User added successfully"),r&&r(null)}).catch(function(e){I(s,e),r&&r("Failed to add user")})}},{key:"remove",value:function(e,t){var a=this,n=x()+"/"+e;E.a.delete(n).then(function(e){I(a,"deleting user successfully"),a.readUsers(t)}).catch(function(e){I(a,e),t&&t()})}},{key:"update",value:function(e,t){for(var a in M)if(M[a].name===e.name)return void(M[a].password=t)}},{key:"start",value:function(e,t){I(this,"start"),t||0===M.length?this.readUsers(e):e&&e()}}]),e}(),A=function(){function e(){Object(u.a)(this,e),this.logOutStr="logedOut",this.userKey="user"}return Object(d.a)(e,[{key:"isAdmin",value:function(){var e=(new F).getUser(this.getLogedInUser());return!(!e||"admin"!==e.role)}},{key:"getLogedInUser",value:function(){var e=(new y.a).get(this.userKey);return e&&e!==this.logOutStr?e:""}},{key:"isLogIn",value:function(){var e=(new y.a).get(this.userKey);return!(!e||e===this.logOutStr)}},{key:"logOut",value:function(){(new y.a).set(this.userKey,this.logOutStr)}},{key:"getLoggedInCustomerId",value:function(){var e=(new F).getUser(this.getLogedInUser());return e?e.customer_id:this.isLogIn()?"admin":""}}]),e}(),D=["Residential buildings","Commercial buildings","Hospitals","Hotels","Agriculture","Food and drinks","Oils and fuels","Emergency services","Utility service provider"],N=["water","diesel","fertilizer"],R={en:{tankName:"Tank Name",buildingName:"Building Name",customer:"Customer",volume:"Volume",leftInTank:"Left In Tank",lastUpdate:"Last Update",capacity:"Capacity",liquid:"Liquid",tankLocation:"Tank Location",tanksLocations:"Tanks Locations",volumeHistory:"Volume History","Last 6H":"Last 6H","Last 12H":"Last 12H","Last 24H":"Last 24H","Last 2 Days":"Last 2 Days","Last Week":"Last Week","Select Range":"Select Range","Custom Range":"Custom Range",latestData:"Latest Data",selectEn:"en - English",selectEs:"es - Spanish",logOut:"Log Out",customerName:"Customer Name",mailAddress:"Mail Address",addNewCustomer:"Add New Customer",add:"Add",cancel:"Cancel",update:"Update",delete:"Delete",addingNewUser:"Adding New User",industry:"Industry","Residential buildings":"Residential buildings","Commercial buildings":"Commercial buildings",Hospitals:"Hospitals",Hotels:"Hotels",Agriculture:"Agriculture","Food and drinks":"Food and drinks","Oils and fuels":"Oils and fuels","Emergency services":"Emergency services","Utility service provider":"Utility service provider",water:"Water",diesel:"Diesel",fertilizer:"Fertilizer"},es:{tankName:"Tank Name",buildingName:"Building Name",customer:"Customer",volume:"Volume",leftInTank:"Left In Tank",lastUpdate:"Last update",capacity:"Capacity",liquid:"Liquid",tankLocation:"Tank Location",tanksLocations:"Tanks Locations",volumeHistory:"Volume History","Last 6H":"Last 6H","Last 12H":"Last 12H","Last 24H":"Last 24H","Last 2 Days":"Last 2 Days","Last Week":"Last Week","Select Range":"Select Range","Custom Range":"Custom Range",latestData:"Latest Data",selectEn:"en - Ingl\xe9s",selectEs:"es - Espa\xf1ol",logOut:"Cerrar sesi\xf3n",customerName:"Nombre del cliente",mailAddress:"Mail Address",addNewCustomer:"Agregar nuevo cliente",add:"A\xf1adir",cancel:"Cancelar",update:"Actualizaci\xf3n",delete:"Borrar",addingNewUser:"Agregando nuevo usuario",industry:"Industria","Residential buildings":"Edificios residenciales","Commercial buildings":"Edificios comerciales",Hospitals:"Hospitales",Hotels:"Hoteles",Agriculture:"Agricultura","Food and drinks":"Alimentos y bebidas","Oils and fuels":"Aceites y combustibles","Emergency services":"Servicios de emergencia","Utility service provider":"Proveedor de servicios p\xfablicos",water:"Agua",diesel:"Diesel",fertilizer:"Fertilizante"}},L=function(){var e=(new y.a).get("lang");return!e||"en"===e&&"es"===e?"en":e},B=function(e){(new y.a).set("lang",e)},P=function(e){var t=R[L()][e];return t||e+" not fond in dic"},H=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleLogOut=function(){(new A).logOut(),window.location.reload()},a.selectLang=function(e){B(e),a.setState({lang:e})},a.state={lang:L()},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(k.a,null),r.a.createElement(k.a,{pullRight:!0}))}}]),t}(n.Component),_=a(15),U=a.n(_),z=!1;function W(){return z}function q(e){return U.a.utc(e-18e6).format("MM/DD-HH:mm")}var V=a(794),K=a(561),G=a(793),Y=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e={color:"#3472F7"};return this.props.color&&(e={color:this.props.color}),r.a.createElement("div",{className:"card"+(this.props.plain?" card-plain":"")},r.a.createElement("div",{className:"header"+(this.props.hCenter?" text-center":"")},r.a.createElement("h4",{className:"title",style:e},r.a.createElement("u",null,r.a.createElement("b",null,this.props.title))),r.a.createElement("p",{className:"category",style:e},this.props.category)),r.a.createElement("div",{className:"content"+(this.props.ctAllIcons?" all-icons":"")+(this.props.ctTableFullWidth?" table-full-width":"")+(this.props.ctTableResponsive?" table-responsive":"")+(this.props.ctTableUpgrade?" table-upgrade":"")},this.props.content,r.a.createElement("div",null,this.props.legend,r.a.createElement("div",{className:"stats"},r.a.createElement("i",{className:this.props.statsIcon,style:e}),r.a.createElement("div",{style:e},"\xa0",this.props.stats)))))}}]),t}(n.Component),$=Y,J=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"card card-stats"},r.a.createElement("div",{className:"content"},r.a.createElement(G.a,null,r.a.createElement(V.a,{xs:12},r.a.createElement("div",{className:"numbers"},r.a.createElement("center",null,this.props.bigIcon,this.props.statsText)),r.a.createElement("div",null,this.props.statsValue))),r.a.createElement("div",{className:"footer"},r.a.createElement("hr",null),r.a.createElement("div",{className:"stats"},this.props.statsIcon," ",this.props.statsIconText))))}}]),t}(n.Component),X=[],Q=function(){function e(){var t=this;Object(u.a)(this,e),this.getImeiFromUrl=function(e){for(var t in X)if(-1!==e.search(X[t].imei))return X[t].imei;return null},this.addTank=function(e,a,n){var r={imei:a.imei,customer:n,iccid:a.iccid,liquid_type:a.liquid_type,capacity:a.capacity,high:a.high,heartbeat_timeout:a.heartbeat_timeout,sampling_interval:a.sampling_interval,phone:a.phone,name:a.name+"--building--"+a.building,level_alerts:a.level_alerts};E.a.post("https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod/tanks",r).then(function(a){I(t,"adding new tank succedded"),e&&e(!0)}).catch(function(a){I(t,a),e&&e(!1)})},this.updateTank=function(e,a,n){var r={imei:a.imei,customer:n,iccid:a.iccid,liquid_type:a.liquid_type,capacity:a.capacity,high:a.high,heartbeat_timeout:a.heartbeat_timeout,sampling_interval:a.sampling_interval,phone:a.phone,name:a.name+"--building--"+a.building,level_alerts:a.level_alerts};E.a.put("https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod/tanks/"+a.imei,r).then(function(t){I("updating tank succedded"),e&&e(!0)}).catch(function(a){I(t,a),e&&e(!1)})},this.deleteTank=function(e,a){var n="https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod/tanks/"+e;I(t,"deleteTank "+n),E.a.delete(n).then(function(e){I("deleting tank succedded"),a&&a()}).catch(function(e){return I(t,e)})}}return Object(d.a)(e,[{key:"getTanks",value:function(){return X}},{key:"getCustomerTanks",value:function(e){var t=[];for(var a in X)X[a].customer!==e&&"admin"!==e||t.push(X[a]);return t}},{key:"getTank",value:function(e){for(var t in X)if(X[t].imei===e)return X[t];return null}},{key:"getTankName",value:function(e){return this.getTank(e).name}},{key:"getCustomerId",value:function(e){return this.getTank(e).customer}},{key:"getCapacity",value:function(e){return this.getTank(e).capacity}},{key:"getLiquidType",value:function(e){return this.getTank(e).liquid_type}},{key:"hasTanks",value:function(e){for(var t in X)if(X[t].customer===e)return!0;return!1}},{key:"readTanks",value:function(e){var t=this,a="https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod/tanks";I(this,"readTanks "+a),E.a.get(a).then(function(a){for(var n in X=a.data){var r=X[n].name.split("--building--");1===r.length?X[n].building="":(X[n].name=r[0],X[n].building=r[1])}I(t,"Got tanks list - "+X.length),e&&e()}).catch(function(e){return I(t,e)})}},{key:"start",value:function(e,t){I(this,"start "+t),t||0===X.length?(X=[],this.readTanks(e)):e&&e()}}]),e}(),Z=function(){function e(){Object(u.a)(this,e),(new Q).start(null,!1)}return Object(d.a)(e,[{key:"getLevelNotifications",value:function(){var e=[],t=(new A).getLoggedInCustomerId(),a=(new Q).getCustomerTanks(t);for(var n in a){this.getLevelNotificationsOnTank(a[n]).map(function(t){return e.push(t)})}return e}},{key:"getLevelNotificationsOnTank",value:function(e){var t=[];for(var a in e.level_alerts){var n=e.level_alerts[a];if("on"===n.status){var r={name:e.name,level:n.at_level};t.push(r)}}return t}},{key:"getHeartBeatNotification",value:function(){var e=[],t=(new A).getLoggedInCustomerId(),a=(new Q).getCustomerTanks(t);for(var n in a){this.getHeartBeatNotificationForTank(a[n]).map(function(t){return e.push(t)})}return e}},{key:"getHeartBeatNotificationForTank",value:function(e){var t=[];return!0!==e.heartbeat_ok&&t.push({name:e.name}),t}}]),e}(),ee=[],te=0,ae=0,ne=function(){function e(){var t=this;Object(u.a)(this,e),this.getLastReadingTime=function(){return ae},this.updateTankReadings=function(e){if(null!==e)if(null===t.from){var a=new Q;I(t,"Readings from "+a.getTankName(e.data.imei)),I(t,"Sample "+e.data.sample_level+" Actual "+e.data.actual_level+" IMEI "+e.data.imei+" server time "+e.data.server_time+" tank time "+e.data.tank_time),ee.push(e.data),ae<e.data.server_time&&(ae=e.data.server_time)}else{var n=e.data;n.imei=(new Q).getImeiFromUrl(e.request.responseURL),t.fromToLevelMonitoring.push(n)}if(t.numberOfreadings+=1,te===t.numberOfreadings)if(null===t.from)t.callBack&&t.callBack();else{var r=t.fromToLevelMonitoring.sort(function(e,t){return parseInt(e.imei,16)-parseInt(t.imei,16)});t.callBack&&t.callBack(r)}},this.tanksInfoReady=function(){var e,a,n=(new Q).getCustomerTanks(t.customer);for(var r in te=n.length,t.numberOfreadings=0,n){var s=(e=n[r].imei,a=!0,e?a?"https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod"+C+"/"+e+"?last=true":"https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod"+C+"/"+e:"https://jx7ltqwdt6.execute-api.us-east-1.amazonaws.com/prod"+C);if(null!=t.from&&null!=t.to&&null!=t.tank){if(te=1,t.tank.imei!==n[r].imei)continue;s=T(n[r].imei,t.from,t.to)}I(t,"level monitoring uri = "+s),E.a.get(s).then(function(e){return t.updateTankReadings(e)}).catch(function(e){I(t,"TanksReadings "+e),t.updateTankReadings(null)})}},this.customer=null,this.callBack=null}return Object(d.a)(e,[{key:"getSortReading",value:function(e,t){var a=new Q;return"name"===t?e.sort(function(e,t){return a.getTankName(e.imei)>a.getTankName(t.imei)?1:-1}):"capacity"===t?e.sort(function(e,t){return a.getCapacity(e.imei)>a.getCapacity(t.imei)?1:-1}):"liquid_type"===t?e.sort(function(e,t){return a.getLiquidType(e.imei).toLowerCase()>a.getLiquidType(t.imei).toLowerCase()?1:-1}):null}},{key:"getLevelMonitoring",value:function(e){return this.getSortReading(ee,e)}},{key:"getLevelMonitoringForTank",value:function(e){var t=0;for(t in ee)if(ee[t].imei===e)return ee[t];return null}},{key:"setClassParams",value:function(e,t,a,n){this.callBack=e,this.from=t,this.to=a,this.customer=(new A).getLoggedInCustomerId(),this.tank=n,(new Q).start(this.tanksInfoReady,!1)}},{key:"getLastReading",value:function(e){I(this,"Asking for last readings"),ee=[],this.setClassParams(e,null,null,null)}},{key:"getReadingFromTo",value:function(e,t,a,n){I(this,"Asking for from to readings"),this.fromToLevelMonitoring=[],this.setClassParams(e,t,a,n)}}]),e}(),re=a(795);function se(e){return 0===e.length?null:r.a.createElement("div",null,e.map(function(e,t){return r.a.createElement(re.a,{bsStyle:"danger",className:"alert-with-icon",key:t},r.a.createElement("center",null,r.a.createElement("span",{"data-notify":"icon",className:"pe-7s-bell"}),r.a.createElement("span",{"data-notify":"message"},"Level is below ",e.level,"% on Tank: ",r.a.createElement("q",null,e.name))))}))}function ie(e){return 0===e.length?null:r.a.createElement("div",null,e.map(function(e,t){return r.a.createElement(re.a,{bsStyle:"danger",className:"alert-with-icon",key:t},r.a.createElement("center",null,r.a.createElement("span",{"data-notify":"icon",className:"pe-7s-bell"}),r.a.createElement("span",{"data-notify":"message"},"Tank: ",r.a.createElement("q",null,e.name)," is not responding")))}))}var le=[],oe=function(){function e(){Object(u.a)(this,e),this.addCustomerToCustomers=function(e){for(var t in le)if(le[t].name===e.name)return;le.push(e)}}return Object(d.a)(e,[{key:"getCustomers",value:function(){return le.sort(function(e,t){return e.name.toLowerCase()>t.name.toLowerCase()?1:0})}},{key:"getCustomer",value:function(e){for(var t in le)if(le[t].id===e)return le[t];return null}},{key:"getCustomerName",value:function(e){var t=this.getCustomer(e);return null!==t?t.name:""}},{key:"readCustomers",value:function(e){var t=this,a=O();I(this,"Customers "+a),E.a.get(a).then(function(a){I(t,"Got customers list "+a.data.length);for(var n=0;n<a.data.length;n++)t.addCustomerToCustomers(a.data[n]);e&&e()}).catch(function(e){return I(t,e)})}},{key:"addNewCustomer",value:function(e,t,a,n){var r=this;for(var s in I(this,"add new customer "+e),le)if(le[s].name.toLowerCase()===e.toLowerCase())return void(n&&n("Customer "+e+" already exist"));E.a.post(O(),{name:e,industry:t,mailing_list:a}).then(function(e){I("adding new customer succedded"),n&&n(null)}).catch(function(e){I(r,e),n&&n("failed to create new customer")})}},{key:"updateCustomer",value:function(e,t){var a=this,n=O()+"/"+e.id;I(this,"updating customer "+n);var r={name:e.name,industry:e.industry,mailing_list:e.mailing_list};E.a.put(n,r).then(function(e){I(a,"updating customer succedded"),t&&t(null)}).catch(function(e){I(a,e),t&&t("failed to create update customer")})}},{key:"deleteCustomer",value:function(e,t){var a=this,n=O()+"/"+e;I(this,"deleteCustomer "+n),E.a.delete(n).then(function(e){I(a,"deleting customer succedded"),t&&t()}).catch(function(e){return I(a,e)})}},{key:"start",value:function(e,t){I(this,"start "+t),t||0===le.length?(le=[],this.readCustomers(e)):e&&e()}}]),e}(),ce=a(22),ue=a(260),de=a.n(ue),me=a(14),pe=5,he=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={value:e.value},!1===a.props.asAlerts?(a.startColor="#3472F7",a.endColor="#089AFA",a.textColor=Object(me.color)("#089AFA").toString()):(a.startColor="red",a.endColor="red",a.textColor="red"),a.tick=a.tick.bind(Object(f.a)(Object(f.a)(a))),a.timeout=pe,a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.tick,2e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"tick",value:function(){this.timeout-=1,0===this.timeout&&this.setState({value:0}),-1===this.timeout&&(this.timeout=pe,this.setState({value:this.props.value}))}},{key:"getTankName",value:function(){return this.props.tank?this.props.tank.name:null}},{key:"getRadiusFromHeight1",value:function(){var e=this.props.height.substring(0,this.props.height.length-1),t=3.5;return window.screen.width<=330?t=2.2:window.screen.width<=360?t=2.8:window.screen.width<=375&&(t=2.7),parseFloat(e,10)*t}},{key:"getRadiusFromHeight",value:function(){var e=this.props.height.substring(0,this.props.height.length-1);return window.innerHeight*e/350}},{key:"renderTank",value:function(){var e=this.getRadiusFromHeight(),t=Object(ce.interpolateRgb)(this.startColor,this.endColor)(this.state.value/100),a=[{key:"0%",stopColor:Object(me.color)(t).darker(.5).toString(),stopOpacity:1,offset:"0%"},{key:"50%",stopColor:t,stopOpacity:.75,offset:"50%"},{key:"100%",stopColor:Object(me.color)(t).brighter(.5).toString(),stopOpacity:.5,offset:"100%"}];return r.a.createElement("div",null,r.a.createElement(de.a,{style:{margin:"0 auto"},width:2*e,height:2*e,value:this.state.value,percent:"%",textSize:1,textOffsetX:0,textOffsetY:0,textRenderer:function(e){var t=Math.round(e.value),a=Math.min(e.height/2,e.width/2),n=e.textSize*a/2,s={fontSize:n},i={fontSize:.6*n};return r.a.createElement("tspan",null,r.a.createElement("tspan",{className:"value",style:s},t),r.a.createElement("tspan",{style:i},e.percent))},riseAnimation:!0,waveAnimation:!0,waveFrequency:1,waveAmplitude:4,gradient:!0,gradientStops:a,circleStyle:{fill:t},waveStyle:{fill:t},textStyle:{fill:this.textColor,fontFamily:"Arial"},waveTextStyle:{fill:Object(me.color)("#fff").toString(),fontFamily:"Arial"},onClick:function(){}}),r.a.createElement("center",null,r.a.createElement("h3",{style:{color:this.startColor}},r.a.createElement("b",null,this.props.volume))))}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderTank())}}]),t}(n.Component),ge=a(796),fe=a(807);function ve(e){var t=6;return 1===e.length&&(t=12),e.map(function(e,a){var n=(new Q).getTank(e.imei);if(null===n)return null;var s=n.name,i=parseInt(n.capacity*e.actual_level/100,10)+" L",l=0!==(new Z).getLevelNotificationsOnTank(n).length,o="#3472F7";return l&&(o="red"),r.a.createElement(V.a,{xs:12,sm:t,key:a},r.a.createElement(Y,{hCenter:!0,id:"chartHours",title:s,color:o,stats:Ee(n,e),content:r.a.createElement(he,{value:e.actual_level,height:"40%",volume:i,asAlerts:l})}))})}function ke(e,t){if(""!==t){var a=(new Q).getCustomerId(e.imei),n=(new oe).getCustomerName(a);if(-1===e.imei.search(t)&&-1===e.name.search(t)&&-1===n.search(t)&&-1===e.capacity.toString().search(t)&&-1===e.liquid_type.search(t))return!0}return!1}function ye(e){return(new A).isAdmin()?(new oe).getCustomerName(e.customer):null}function be(e,t){return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("center",null,e)),r.a.createElement("td",null,r.a.createElement("center",null,t)))}function Ee(e,t){return r.a.createElement("div",null,r.a.createElement(ge.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("tbody",null,be(P("tankName"),e.name),be(P("buildingName"),e.building),null!==ye(e)&&be("Customer",ye(e)),be(P("capacity"),e.capacity+" L"),null!==t&&be(P("volume"),parseInt(e.capacity*t.actual_level/100,10)+" L"),null!==t&&be(P("leftInTank"),t.actual_level+"%"),null!==t&&be(P("lastUpdate"),(a=t.server_time,U.a.utc(a-18e6).format("hh:mm a Do of MMMM YYYY"))),be(P("liquid"),P(e.liquid_type)))));var a}function we(e){return r.a.createElement(V.a,{md:4},r.a.createElement(Y,{id:"filterTanks",title:"Filter Tanks",hCenter:!0,content:r.a.createElement(fe.a,{type:"text",value:e.state.value,placeholder:"Tank / Customer / Capacity / IMEI",onChange:function(t){return e.setState({filterStr:t.target.value})}})}))}var Se=function e(){var t=this;Object(u.a)(this,e),this.getFirstRangeInHours=function(){return t.rangesValues[0]},this.getRanges=function(){return t.ranges},this.getRangeInHour=function(e){return t.rangesValues[e]},this.getSelectedString=function(e){return e===t.ranges.length-1?P("Custom Range"):P(t.ranges[e])},this.getRangeForHourse=function(e,a,n){var r=new ne,s=r.getLastReadingTime()-60*e*60*1e3,i=r.getLastReadingTime();I(t,s+" "+i),t.callback=a,r.getReadingFromTo(t.rangeReady,s,i,n)},this.getRangeFromTo=function(e,a,n,r){t.callback=n,(new ne).getReadingFromTo(t.rangeReady,e,a,r)},this.rangeReady=function(e){0!==e.length&&t.callback&&t.callback(e)},this.ranges=["Last 6H","Last 12H","Last 24H","Last 2 Days","Select Range"],this.rangesValues=[6,12,24,48,null]},Ce=a(804),Te=a(200),Oe=(a(42),a(261)),xe=a.n(Oe),je=a(56),Ie=(a(462),a(475),{onHide:null,autoFocus:!1,autoFocusEndDate:!1,initialStartDate:new U.a,initialEndDate:new U.a,startDateId:je.START_DATE,startDatePlaceholderText:"Start Date",endDateId:null,endDatePlaceholderText:"End Date",disabled:!1,required:!1,screenReaderInputMessage:"",showClearDates:!1,showDefaultInputIcon:!1,customInputIcon:null,customArrowIcon:null,customCloseIcon:null,block:!1,small:!1,regular:!1,renderMonthText:null,orientation:je.VERTIVAL_ORIENTATION,anchorDirection:je.ANCHOR_LEFT,horizontalMargin:0,withPortal:!1,withFullScreenPortal:!1,initialVisibleMonth:null,numberOfMonths:2,keepOpenOnDateSelect:!1,reopenPickerOnClearDates:!1,isRTL:!1,navPrev:null,navNext:null,onPrevMonthClick:function(){},onNextMonthClick:function(){},onClose:function(){},renderCalendarDay:void 0,renderDayContents:null,minimumNights:0,enableOutsideDays:!1,isDayBlocked:function(){return!1},isOutsideRange:function(){return!1},isDayHighlighted:function(){return!1},displayFormat:function(){return U.a.localeData().longDateFormat("L")},monthFormat:"MMMM YYYY",phrases:je.DateRangePickerPhrases,stateDateWrapper:function(e){return e}}),Me=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).getNumberOfMonth=function(){return window.innerWidth<=994?1:2},a.handelClose=function(e){e&&a.props.onHide(a.state.startDate.toDate(),e.endDate.toDate())};var n=null;return e.autoFocus?n=je.START_DATE:e.autoFocusEndDate&&(n=je.END_DATE),a.state={focusedInput:n,startDate:e.initialStartDate,endDate:e.initialEndDate,startDateId:0},a.onDatesChange=a.onDatesChange.bind(Object(f.a)(Object(f.a)(a))),a.onFocusChange=a.onFocusChange.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"onDatesChange",value:function(e){var t=e.startDate,a=e.endDate,n=this.props.stateDateWrapper;this.setState({startDate:t&&n(t),endDate:a&&n(a)})}},{key:"onFocusChange",value:function(e){this.setState({focusedInput:e})}},{key:"render",value:function(){var e=this,t=this.state,a=t.focusedInput,n=t.startDate,s=t.endDate,i=xe()(this.props,["autoFocus","autoFocusEndDate","initialStartDate","initialEndDate","stateDateWrapper"]);return r.a.createElement("div",null,r.a.createElement(je.DateRangePicker,Object.assign({},i,{numberOfMonths:this.getNumberOfMonth(),onDatesChange:this.onDatesChange,onFocusChange:this.onFocusChange,focusedInput:a,startDate:n,endDate:s,onClose:function(t){return e.handelClose(t)}})))}}]),t}(r.a.Component);Me.defaultProps=Ie;var Fe=Me,Ae=a(806),De=a(797),Ne=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).createTimeArray=function(){for(var e=[],t=0;t<24;t++){var a=""+t;t<10&&(a="0"+t),e.push(a+":00"),e.push(a+":30")}return e},a.dateSelected=function(e,t){a.setState({startDate:e,endDate:t})},a.closeModal=function(){a.props.onHide(a.state.startDate,a.state.endDate,a.state.startTime,a.state.endTime),a.setState({startTime:"00:00 AM",endTime:"24:00 PM",startDate:new Date,endDate:new Date})},a.quickSelection=function(e){a.props.onHide(null,null,e,null)},a.timeArray=a.createTimeArray(),a.state={startTime:"00:00 AM",endTime:"24:00 PM",startDate:new Date,endDate:new Date},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(Ce.a,Object.assign({},this.props,{bsSize:"small","aria-labelledby":"contained-modal-title-sm"}),r.a.createElement(Ce.a.Header,{closeButton:!0},r.a.createElement(Ce.a.Title,{id:"contained-modal-title-sm"},"Date Range Selection")),r.a.createElement(Ce.a.Body,null,r.a.createElement(Fe,{onHide:this.dateSelected,startDateId:"2",endDateId:"2"})),r.a.createElement("div",null,r.a.createElement("center",null,"Select Start & End Time"),r.a.createElement("p",null)),r.a.createElement("div",null,r.a.createElement("center",null,r.a.createElement(Ae.a,{title:this.state.startTime,id:"dropdown-size-medium",onSelect:function(t){return e.setState({startTime:e.timeArray[t]})}},this.timeArray.map(function(e,t){return r.a.createElement(De.a,{key:t,eventKey:t},r.a.createElement("strong",null,e))})),"\xa0\xa0",r.a.createElement(Ae.a,{title:this.state.endTime,id:"dropdown-size-medium",onSelect:function(t){return e.setState({endTime:e.timeArray[t]})}},this.timeArray.map(function(e,t){return r.a.createElement(De.a,{key:t,eventKey:t},r.a.createElement("strong",null,e))})))),r.a.createElement("p",null),r.a.createElement(Ce.a.Footer,null,r.a.createElement(Te.a,{onClick:this.closeModal},"Select")))}}]),t}(r.a.Component),Re=a(798),Le=a(515),Be=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).tankSelected=function(e){a.setState({selectedTankName:a.tanks[e].name}),a.props.tankSelected&&a.props.tankSelected(a.tanks[e])},a.getTankName=function(){return null===a.state.selectedTankName?a.props.getSelectedTank().name:a.state.selectedTankName},a.state={selectedTankName:null};var n=(new A).getLoggedInCustomerId();return a.tanks=(new Q).getCustomerTanks(n),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.getTankName();return r.a.createElement(Le.a,null,r.a.createElement(Ae.a,{title:"Select Tank - "+t,bsStyle:"primary",style:{margin:"3px"},id:"bg-nested-dropdown"},this.tanks.map(function(t,a){return r.a.createElement(De.a,{eventKey:a,key:a,onClick:function(){return e.tankSelected(a)}},t.name)})))}}]),t}(r.a.Component),Pe=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).rangeSelected=function(e){I(Object(f.a)(Object(f.a)(a)),"rangeSelected "+e);var t=(new Se).getRangeInHour(e);null===t?a.setState({showDateAndTimeModal:!0}):a.props.hoursSelected(t,e)},a.getDate=function(e,t){var a=parseInt(t.substring(0,2),10),n=parseInt(t.substring(3,5),10);return e.setHours(a),e.setMinutes(n),e},a.dateAndTimeModalClose=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null!==e&&null!==t&&null!==n&&null!==r){var s=a.getDate(e,n),i=a.getDate(t,r);a.props.rangeSelected(s.getTime(),i.getTime())}else a.props.hoursSelected(6,0);a.setState({showDateAndTimeModal:!1})},a.state={showDateAndTimeModal:!1},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=(new Se).getRanges();return r.a.createElement("div",null,r.a.createElement(Re.a,null,r.a.createElement(Le.a,null,r.a.createElement(Be,{tankSelected:this.props.tankSelected,getSelectedTank:this.props.getSelectedTank}),r.a.createElement(Te.a,{style:{opacity:"0"}},"spacer it")),r.a.createElement(Le.a,null,t.map(function(t,a){return r.a.createElement(Te.a,{bsStyle:"primary",value:a,style:{margin:"3px"},key:a,onClick:function(){return e.rangeSelected(a)}},t)}))),r.a.createElement(Ne,{show:this.state.showDateAndTimeModal,onHide:this.dateAndTimeModalClose}))}}]),t}(n.Component),He=(a(516),a(58)),_e=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).getData=function(e){if(void 0===a.props.maxPoints||null===a.props.maxPoints)return e;if(a.props.maxPoints>e.length)return e;for(var t=parseInt(e.length/a.props.maxPoints,10),n=e.length-2;n>0;n--)n%t!==0&&e.splice(n,1);return e},a.myFormatter=function(e,t){var a=q(e).split("-");return r.a.createElement("tspan",null,r.a.createElement("tspan",{x:"0",dy:"1em"},a[0]),r.a.createElement("tspan",{x:"0",dy:"1em"},a[1]))},a.getLegendItems=function(){var e=[];for(var t in a.props.data){var n=a.props.data[t];if(0!==n.length&&""!==n[0].tankName){var r={title:n[0].tankName,color:a.colors[t%a.colors.length]};e.push(r)}}return e},a.getxValues=function(e){for(var t in a.props.data){var n=a.props.data[t].length;if(n>2){var r=[],s=a.props.data[t],i=s[0].x-s[0].x%36e5+36e5,l=parseInt((s[n-1].x-s[0].x-6e4)/1e3/60/60,10),o=36e5*(parseInt(l/6,10)+1);e>5?(o/=2,s[0].x<i-o&&(i-=o)):l>12&&(e+=1);for(var c=0;c<e;c++)r.push(i+c*o);return r}}return null},a.state={crosshairValues:[]},a.colors=["blue","red","green","black","orange","grey"],a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=window.innerWidth<=994?5:12,a=this.getLegendItems(),n=this.getxValues(t);return r.a.createElement("div",null,r.a.createElement(He.b,{height:360,margin:{left:60}},r.a.createElement(He.a,{items:a,orientation:"horizontal"}),r.a.createElement(He.c,{style:{stroke:"#B7E9ED"}}),r.a.createElement(He.e,{style:{stroke:"#B7E9ED"}}),r.a.createElement(He.f,{title:"",tickValues:n,tickFormat:this.myFormatter,style:{line:{stroke:"#ADDDE1"},ticks:{stroke:"#ADDDE1"},text:{stroke:"none",fill:"#6b6b76",fontWeight:600}}}),r.a.createElement(He.g,{title:"",tickTotal:15,tickFormat:function(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+"L"},style:{size:10}}),this.props.data.map(function(t,a){return r.a.createElement(He.d,{key:a,xType:"time",className:"series"+{index:a},color:e.colors[a%e.colors.length],data:e.getData(t)})})))}}]),t}(r.a.Component),Ue=a(75),ze=null,We=null;function qe(e){ze=e}function Ve(e){We=e}function Ke(e,t){if(""!==t){var a=(new Q).getTanks();for(var n in a)if(a[n].imei===e)return ke(a[n],t)}return!1}function Ge(e,t){if(""!==t&&0!==e.length){for(var a=Object(Ue.a)(e),n=a.length-1;n>=0;n--)Ke(a[n].imei,t)&&a.splice(n,1);return a}return e}var Ye=a(266),$e=a.n(Ye),Je=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement($e.a,{type:"Oval",color:"#00BFFF",height:"100",width:"100"})}}]),t}(r.a.Component),Xe=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentWillUnmount=function(){clearInterval(a.timer)},a.tick=function(){if(W()){var e=new Se;a.hoursSelected(e.getFirstRangeInHours(),0),clearInterval(a.timer)}},a.hoursSelected=function(e,t){a.setState({graphReadings:[],rangeIndex:t,index:t,hours:e,start:null,end:null}),(new Se).getRangeForHourse(e,a.rangeReady,a.getSelectedTank())},a.rangeSelected=function(e,t){var n=new Se;a.setState({rangeIndex:(new Se).getRanges().length-1,index:null,hours:null,start:e,end:t}),n.getRangeFromTo(e,t,a.rangeReady,a.getSelectedTank())},a.rangeReady=function(e){a.setState({graphReadings:e,rangeReady:!0})},a.tankSelected=function(e){qe(e),null===a.state.start?a.hoursSelected(a.state.hours,a.state.index):a.rangeSelected(a.state.start,a.state.end)},a.getSelectedTank=function(){return ze},a.state={graphReadings:[],rangeIndex:0,rangeReady:!1},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.tick,250)}},{key:"rangeReadingToGraphData",value:function(){var e=[],t=0,a=Ge(this.state.graphReadings,""),n=new Q,r=0;for(var s in a){var i=a[s],l=[],o=n.getTank(a[s].imei);for(var c in i.levels){var u={x:i.times[c],y:i.levels[c]*o.capacity/100,tankName:o.name};l.push(u),i.times[c]>t&&(t=i.times[c]),o.capacity>r&&(r=o.capacity)}e.push(l)}var d=[];return d.push({x:t,y:1.2*r,tankName:""}),e.push(d),(d=[]).push({x:t,y:0,tankName:""}),e.push(d),e}},{key:"render",value:function(){if(!1===this.state.rangeReady)return r.a.createElement($,{hCenter:!0,title:"Loading Graph...",content:r.a.createElement("center",null,r.a.createElement(Je,null))});var e=this.rangeReadingToGraphData(),t=(new Se).getSelectedString(this.state.rangeIndex)+" for tank: "+this.getSelectedTank().name;return r.a.createElement(V.a,{md:12},r.a.createElement($,{id:"visGraph",title:P("volumeHistory"),category:t,hCenter:!0,stats:r.a.createElement(Pe,{hoursSelected:this.hoursSelected,rangeSelected:this.rangeSelected,tankSelected:this.tankSelected,getSelectedTank:this.getSelectedTank}),content:r.a.createElement("div",{style:{height:"380px"}},r.a.createElement(_e,{data:e,maxPoints:100}))}))}}]),t}(n.Component);var Qe=function(e){function t(e){var n,s=this;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentDidMount=function(){Promise.all([a.e(3),a.e(1)]).then(a.bind(null,801)).then(function(e){n.ExcelTable=e,n.setState({excelTableReady:!0}),console.log("excelTable Ready")})},n.getHeader=function(){return["ID","Tank","Left in Tank (%)","Volume","Time"]},n.createData=function(){I(Object(f.a)(Object(f.a)(n)),"createData ---\x3e"),n.arrayForExcel=[[]],n.arrayForPdf=[[]],n.arrayForTable=[],n.tanksNames=[];var e=new Q,t=1;for(var a in n.props.rangeReadings){var r=e.getTank(n.props.rangeReadings[a].imei),s=r.name;for(var i in n.tanksNames.push(s),n.arrayForExcel[a]=[],n.arrayForPdf[a]=[],n.arrayForPdf[a].push([s,"Time","Left In Tank","Volume"]),n.props.rangeReadings[a].levels){var l=q(n.props.rangeReadings[a].times[i]),o=n.props.rangeReadings[a].levels[i],c=n.props.rangeReadings[a].samples[i],u=o*r.capacity/100,d=[t++,s,o+" %",u+" L",l];n.arrayForTable.push(d);var m={time:l,level:o+" %",vol:u+" L",samples:c};n.arrayForExcel[a].push(m),n.arrayForPdf[a].push(["",l,o+" %",u+" L"])}if(0===n.props.rangeReadings[a].levels.length){var p=["!!!!!!!",s,"No History For This Tank","!!!!!!!","!!!!!!!"];n.arrayForTable.push(p)}}I(Object(f.a)(Object(f.a)(n)),"<--- create data")},n.creatPdfDocDefinition=function(){var e=[];for(var t in n.arrayForPdf){var a={style:"tableExample",table:{headerRows:1,widths:["*","*","*","*"],body:n.arrayForPdf[t]}};e.push(a),e.push({text:"",pageBreak:"after",style:"subheader"})}return e},n.exportToPdf=function(e){!function(e,t){a.e(4).then(a.t.bind(null,802,7)).then(function(n){console.log("pdfMake loded");var r={compress:!0,content:t};a.e(5).then(a.t.bind(null,803,7)).then(function(t){n.vfs=t.pdfMake.vfs,n.tableLayouts={exampleLayout:{hLineWidth:function(e,t){return 0===e||e===t.table.body.length?0:e===t.table.headerRows?2:1},vLineWidth:function(e){return 0},hLineColor:function(e){return 1===e?"black":"#aaa"},paddingLeft:function(e){return 0===e?0:8},paddingRight:function(e,t){return e===t.table.widths.length-1?0:8}}},"export"===e&&n.createPdf(r).download("NTCL-MonitoringData.pdf"),"print"===e&&n.createPdf(r).print()}).catch(function(e){console.log(e+"Error importing pdfFonts")})}).catch(function(e){console.log(e+"Error importing pdfMake")})}(e,n.creatPdfDocDefinition())},n.renderExport=function(){return console.log("renderExport"),r.a.createElement("div",null,r.a.createElement("div",null,n.props.rangeButtons),r.a.createElement("div",null,r.a.createElement(s.ExcelTable.default,{button:r.a.createElement(Te.a,{bsStyle:"primary",style:{margin:"3px"}},"Export To Excel"),data:n.arrayForExcel,tanksNames:n.tanksNames}),r.a.createElement(Te.a,{bsStyle:"primary",style:{margin:"3px"},onClick:function(){return n.exportToPdf("export")}},"Export To PDF"),!1===!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&r.a.createElement(Te.a,{bsStyle:"primary",style:{margin:"3px"},onClick:function(){return n.exportToPdf("print")}},"Print")))},n.arrayForTable=[],n.arrayForExcel=[[]],n.arrayForPdf=[[]],n.tanksNames=[],n.state={excelTableReady:!1},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){if(!1===this.state.excelTableReady)return null;console.log("render TableList "),this.createData();var e=this.getHeader();return r.a.createElement(V.a,{md:12},r.a.createElement($,{title:this.props.title,category:this.props.category,hCenter:!0,ctTableFullWidth:!0,stats:this.renderExport(),content:r.a.createElement("div",{style:{height:"50%",overflowY:"auto"}},r.a.createElement(ge.a,{striped:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,e.map(function(e,t){return r.a.createElement("th",{key:t},e)}))),r.a.createElement("tbody",{style:{overflow:"auto"}},this.arrayForTable.map(function(e,t){return r.a.createElement("tr",{key:t},e.map(function(e,t){return r.a.createElement("td",{key:t},e)}))}))))}))}}]),t}(n.Component),Ze=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentWillUnmount=function(){clearInterval(a.timer)},a.tick=function(){if(W()){var e=new Se;clearInterval(a.timer),a.hoursSelected(e.getFirstRangeInHours(),0)}},a.hoursSelected=function(e,t){a.setState({tableReadings:[],rangeIndex:t,index:t,hours:e,start:null,end:null}),(new Se).getRangeForHourse(e,a.rangeReady,a.getSelectedTank())},a.rangeSelected=function(e,t){var n=new Se;a.setState({rangeIndex:(new Se).getRanges().length-1,index:null,hours:null,start:e,end:t}),n.getRangeFromTo(e,t,a.rangeReady,a.getSelectedTank())},a.tankSelected=function(e){Ve(e),null!==a.state.start?a.rangeSelected(a.state.start,a.state.end):a.hoursSelected(a.state.hours,a.state.index)},a.getSelectedTank=function(){return We},a.rangeReady=function(e){a.setState({tableReadings:e,rangeReady:!0})},a.state={tableReadings:[],rangeIndex:0,rangeReady:!1},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.tick,250)}},{key:"render",value:function(){return!1===this.state.rangeReady?r.a.createElement(V.a,{md:12},r.a.createElement($,{hCenter:!0,title:"Loading Data...",content:r.a.createElement("center",null,r.a.createElement(Je,null))})):r.a.createElement(Qe,{rangeReadings:Ge(this.state.tableReadings,""),title:P("latestData"),rangeButtons:r.a.createElement(Pe,{hoursSelected:this.hoursSelected,rangeSelected:this.rangeSelected,tankSelected:this.tankSelected,getSelectedTank:this.getSelectedTank}),category:(new Se).getSelectedString(this.state.rangeIndex)})}}]),t}(n.Component),et=a(201),tt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).onMarkerClick=function(e,t,n){a.setState({selectedPlace:e,activeMarker:t,showingInfoWindow:!0})},a.onMouseOver=function(e,t,n){a.activeMarkerTitle!==t.title&&(a.activeMarkerTitle=t.title,a.setState({selectedPlace:e,activeMarker:t,showingInfoWindow:!0}))},a.onMapClicked=function(e){a.state.showingInfoWindow&&a.setState({showingInfoWindow:!1,activeMarker:null}),a.activeMarkerTitle=""},a.renderMarkers=function(e){return e.map(function(e,t){return r.a.createElement(et.Marker,{onClick:a.onMarkerClick,onMouseover:a.onMouseOver,title:""+t,info:e.info,key:t,position:{lat:e.lat,lng:e.lng}})})},a.getCenter=function(e){var t=0,a=0,n=0;for(var r in e)0!==e[r].lat&&0!==e[r].lng||(n+=1),t+=e[r].lat,a+=e[r].lng;var s=e.length-n!==0?e.length-n:1;return{lat:t/s,lng:a/s}},a.convertGpsPosition=function(e){var t=parseFloat(e.lat.substring(0,9),10),a=parseFloat(e.lng.substring(0,10),10),n="N"===e.lat[9]?1:-1,r="E"===e.lng[10]?1:-1;return{info:e.info,lat:(Math.floor(t/100)+t%100/60)*n,lng:(Math.floor(a/100)+a%100/60)*r}},a.state={showingInfoWindow:!1,activeMarker:{},selectedPlace:{}},a.activeMarkerTitle="",a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e={height:this.props.height,position:"relative"},t=[];for(var a in this.props.markers)t.push(this.convertGpsPosition(this.props.markers[a]));return r.a.createElement("div",{style:e},r.a.createElement("center",null,r.a.createElement(et.Map,{google:window.google,zoom:this.props.zoom,style:{width:"90%",height:"90%",position:"relative"},onClick:this.onMapClicked,onReady:this.mapIsReady,initialCenter:this.getCenter(t)},this.renderMarkers(t),r.a.createElement(et.InfoWindow,{marker:this.state.activeMarker,visible:this.state.showingInfoWindow},r.a.createElement("div",null,this.state.selectedPlace.info)))))}}]),t}(n.Component),at=Object(et.GoogleApiWrapper)({apiKey:"AIzaSyAugb6uKPRiLYNHII5GEgQxHVSTL73IUVk"})(tt),nt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentWillUnmount=function(){clearInterval(a.timer)},a.tick=function(){W()&&(a.setState({lastTanksReadings:(new ne).getLevelMonitoring("name")}),clearInterval(a.timer))},a.renderInfo=function(e){var t=(new Q).getTank(e.imei);return r.a.createElement(ge.a,{striped:!0,bordered:!0,condensed:!0,hover:!0},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("center",null,"Tank Name")),r.a.createElement("td",null,r.a.createElement("center",null,t.name))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("center",null,"Building")),r.a.createElement("td",null,r.a.createElement("center",null,t.building)))))},a.getMarkers=function(){var e=a.props.filterStr;null!==e&&void 0!==e||(e="");var t=[],n=Ge(a.state.lastTanksReadings,e);for(var r in n){var s=a.renderInfo(n[r]);t.push({info:s,lat:n[r].gps.lat,lng:n[r].gps.long})}return t},a.state={lastTanksReadings:[]},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.tick,250)}},{key:"render",value:function(){var e=this.getMarkers();if(0===e.length)return null;var t=P("tankLocation");e.length>1&&(t=P("tanksLocations"));var a=this.props.fromDashbord?"40%":"80%";return r.a.createElement(V.a,{xs:12},r.a.createElement(Y,{hCenter:!0,statsIcon:"fa fa-history",id:"chartHours",title:t,stats:"Updated",content:r.a.createElement(at,{height:a,markers:e,zoom:13})}))}}]),t}(n.Component),rt=a(267),st=a.n(rt),it=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentWillUnmount=function(){clearInterval(a.timer),clearInterval(a.fastTimer)},a.tick=function(){a.tickToggle?(new ne).getLastReading(a.tanksReadingReady):(new Q).start(a.dataIsReady,!0),a.tickToggle=!a.tickToggle},a.fastTick=function(){W()&&(a.dataIsReady(),clearInterval(a.fastTimer))},a.dataIsReady=function(){var e=new Q,t=new A,n=t.getLoggedInCustomerId();t.isAdmin()?a.setState({tanks:e.getTanks()}):a.setState({tanks:e.getCustomerTanks(n)}),a.tanksReadingReady()},a.tanksReadingReady=function(){var e=(new ne).getLevelMonitoring("name");e&&a.setState({lastTanksReadings:e})},a.renderAlerts=function(){var e=new Z,t=e.getLevelNotifications(),n=e.getHeartBeatNotification();return 0===t.length&&0===n.length?null:r.a.createElement(V.a,{xs:12,onClick:function(){return a.props.history.push("alerts")}},r.a.createElement(J,{statsText:r.a.createElement("div",{style:{animation:"scale 0.5s linear infinite alternate",color:"red"}},r.a.createElement("i",{className:"pe-7s-gleam text-danger"},"Alerts")),statsValue:r.a.createElement("div",null,r.a.createElement("br",null),se(t),ie(n)),statsIcon:r.a.createElement("i",{className:"fa fa-clock-o"}),statsIconText:"Click for more info"}))},a.state={tanks:[],lastTanksReadings:[],filterStr:""},a.getRangeReadingOnce=!0,a.tickToggle=!0,a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.tick,35e3),this.fastTimer=setInterval(this.fastTick,250)}},{key:"createLegend",value:function(e){for(var t=[],a=0;a<e.names.length;a++){var n="fa fa-circle text-"+e.types[a];t.push(r.a.createElement("i",{className:n,key:a})),t.push(" "),t.push(e.names[a])}return t}},{key:"renderTanks",value:function(){return ve(Ge(this.state.lastTanksReadings,this.state.filterStr))}},{key:"render",value:function(){return 0===this.state.tanks.length?r.a.createElement(Y,{hCenter:!0,title:"Loading ...",content:r.a.createElement("center",null,r.a.createElement(Je,null))}):r.a.createElement("div",{className:"content"},r.a.createElement("center",null,r.a.createElement("img",{src:st.a,alt:"logo_image",style:{height:"8.5%"}})),r.a.createElement("p",null),r.a.createElement(K.a,{fluid:!0},r.a.createElement(G.a,null,we(this)),r.a.createElement(G.a,null,this.renderAlerts()),r.a.createElement(G.a,null,this.renderTanks()),r.a.createElement(G.a,null,r.a.createElement(Xe,null)),r.a.createElement(G.a,null,r.a.createElement(nt,{filterStr:this.state.filterStr,fromDashbord:!0})),r.a.createElement(G.a,null,r.a.createElement(Ze,null))))}}]),t}(n.Component),lt=a(799),ot=a(800),ct=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).restCallBack=function(e){e?a.setState({hideButtons:!1,formMessage:e}):(a.props.onHide(),a.setState({hideButtons:!1,formMessage:""}))},a.deleteMail=function(e){var t=a.state.mailingList;a.props.customer&&(t=a.props.customer.mailing_list),t.splice(e,1),a.setState({mailingList:t}),a.props.customer&&(a.props.customer.mailing_list=t)},a.addMail=function(){if("error"===a.validateMail(a.state.mailAddrees))a.setState({formMessage:"Mail is not valid"});else{var e=a.state.mailingList;e.push(a.state.mailAddrees),a.setState({mailingList:e,formMessage:null}),a.props.customer&&(a.props.customer.mailing_list=e)}},a.createMailForm=function(e,t){return r.a.createElement("div",{align:"left",key:t},r.a.createElement(Te.a,{style:{margin:"3px"},value:t,onClick:function(e){return a.deleteMail(e.target.value)}},"Remove"),"\xa0 ",e)},a.state={customerName:"",hideButtons:!1,formMessage:null,mailingList:[],industry:D[0]},a.style={color:"#3472F7"},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"addNewCustomer",value:function(){"error"!==this.validatCustomer()?(this.setState({hideButtons:!0,formMessage:"Adding New Customer..."}),(new oe).addNewCustomer(this.state.customerName,this.state.industry,this.state.mailingList,this.restCallBack)):this.setState({formMessage:"Invalid customer name"})}},{key:"updateCustomer",value:function(){I(this,"updating "+this.props.customer.name),(new oe).updateCustomer(this.props.customer,this.restCallBack)}},{key:"validateMail",value:function(e){return e&&0!==e.length&&!1===/\S+@\S+\.\S+/.test(e)?"error":"success"}},{key:"validatCustomer",value:function(){return this.state.customerName.length>2?"success":"error"}},{key:"renderFormCustomerFiled",value:function(){var e=this,t=this.state.mailingList;return this.props.customer&&(t=Object(Ue.a)(this.props.customer.mailing_list)),r.a.createElement("div",null,null===this.props.customer&&r.a.createElement(lt.a,{controlId:"formBasicText",validationState:this.validatCustomer()},r.a.createElement("center",null,r.a.createElement(ot.a,{style:this.style},P("customerName"))),r.a.createElement(fe.a,{type:"text",placeholder:P("customerName"),onChange:function(t){e.setState({customerName:t.target.value,formMessage:null})}})),null===this.props.customer&&r.a.createElement(lt.a,{controlId:"formBasicText"},r.a.createElement("center",null,r.a.createElement(ot.a,{style:this.style},P("industry"))),r.a.createElement(fe.a,{componentClass:"select",onChange:function(t){return e.setState({industry:t.target.value})}},D.map(function(e,t){return r.a.createElement("option",{key:t,value:e},P(e))}))),t.length>0&&r.a.createElement("center",null,r.a.createElement(ot.a,{style:this.style},"Alerts Mails")),t.map(function(t,a){return e.createMailForm(t,a)}),r.a.createElement("hr",null),r.a.createElement(lt.a,{controlId:"formBasicText",validationState:this.validateMail()},r.a.createElement("center",null,r.a.createElement(ot.a,{style:this.style},P("mailAddress"))),r.a.createElement(fe.a,{type:"email",placeholder:P("mailAddress"),onChange:function(t){e.setState({mailAddrees:t.target.value,formMessage:null})}})),r.a.createElement("center",null,r.a.createElement(Te.a,{onClick:function(t){return e.addMail(t)}},"Add Alerts Mail")))}},{key:"createForm",value:function(){return r.a.createElement("form",null,this.renderFormCustomerFiled(),r.a.createElement("center",null,r.a.createElement("div",null,this.state.formMessage)))}},{key:"deleteCustomer",value:function(){I(this,"deleteCustomer "+this.props.customer.id),(new oe).deleteCustomer(this.props.customer.id),this.props.onHide()}},{key:"renderButtons",value:function(){var e=this;return!0===this.state.hideButtons?null:r.a.createElement("div",null,r.a.createElement(Te.a,{onClick:this.props.onHide},P("cancel")),null==this.props.customer?r.a.createElement(Te.a,{onClick:function(){return e.addNewCustomer()}},P("add")):r.a.createElement(Te.a,{onClick:function(){return e.updateCustomer()}},P("update")))}},{key:"render",value:function(){var e=P("addNewCustomer");return r.a.createElement(Ce.a,Object.assign({},this.props,{bsSize:"small","aria-labelledby":"contained-modal-title-sm"}),r.a.createElement(Ce.a.Header,{closeButton:!0},r.a.createElement(Ce.a.Title,{id:"contained-modal-title-sm",style:this.style},this.props.customer?"Manage Customer - "+this.props.customer.name:e)),r.a.createElement(Ce.a.Footer,null,this.createForm()),r.a.createElement(Ce.a.Footer,null,this.renderButtons()))}}]),t}(r.a.Component),ut=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).restCallBack=function(e){e?a.setState({hideButtons:!1,settingMessage:e}):(a.setState({hideButtons:!1,settingMessage:"done"}),a.props.onHide())},a.validate=function(e){return e.length>2&&-1===e.indexOf(" ")?"success":"error"},a.validatPass=function(){return a.validate(a.state.password)},a.state={userName:"",password:"",hideButtons:!1,settingMessage:null},a.style={color:"#3472F7"},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"addNewUser",value:function(){this.setState({hideButtons:!0,settingMessage:P("addingNewUser")}),(new F).add(this.state.userName,this.state.password,this.props.customer.id,this.props.customer.name,this.restCallBack)}},{key:"validatUser",value:function(){return this.validate(this.state.userName)}},{key:"renderFormUsersFiled",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(lt.a,{controlId:"formBasicText",validationState:this.validatUser()},r.a.createElement("center",null,r.a.createElement(ot.a,{style:this.style},"User Name")),r.a.createElement(fe.a,{type:"text",placeholder:"User Name",onChange:function(t){e.setState({userName:t.target.value,settingMessage:null})}})),r.a.createElement(lt.a,{controlId:"formBasicText",validationState:this.validatPass()},r.a.createElement("center",null,r.a.createElement(ot.a,{style:this.style},"Password")),r.a.createElement(fe.a,{type:"text",placeholder:"Password",onChange:function(t){e.setState({password:t.target.value,settingMessage:null})}})))}},{key:"createForm",value:function(){return r.a.createElement("form",null,this.renderFormUsersFiled(),r.a.createElement("center",null,r.a.createElement("div",null,this.state.settingMessage)))}},{key:"renderButtons",value:function(){var e=this;return!0===this.state.hideButtons?null:r.a.createElement("div",null,r.a.createElement(Te.a,{onClick:this.props.onHide},"Cancel"),"success"===this.validatUser()&&"success"===this.validatPass()&&r.a.createElement(Te.a,{onClick:function(){return e.addNewUser()}},"Add"))}},{key:"render",value:function(){return I(this,"render"),r.a.createElement(Ce.a,Object.assign({},this.props,{bsSize:"small","aria-labelledby":"contained-modal-title-sm"}),r.a.createElement(Ce.a.Header,{closeButton:!0},r.a.createElement(Ce.a.Title,{id:"contained-modal-title-sm",style:this.style},"Add New User")),r.a.createElement(Ce.a.Footer,null,this.createForm()),r.a.createElement(Ce.a.Footer,null,this.renderButtons()))}}]),t}(r.a.Component),dt=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(Ce.a,Object.assign({},this.props,{bsSize:"lg","aria-labelledby":"contained-modal-title-sm"}),r.a.createElement(Ce.a.Header,{closeButton:!0},r.a.createElement(Ce.a.Title,{id:"contained-modal-title-sm"},this.props.title)),r.a.createElement(Ce.a.Body,null,this.props.text.map(function(e,t){return r.a.createElement("div",{key:t},e)})))}}]),t}(r.a.Component),mt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).updateSettingsTimeOut=function(){a.setState({showSettingsModal:!1,settingsModalText:[]}),a.props.onHide(),clearInterval(a.timer)},a.updateSettingsModal=function(e,t){I(Object(f.a)(Object(f.a)(a)),"updateSettingsModal "+e),I(Object(f.a)(Object(f.a)(a)),"updateSettingsModal "+a.state.settingsModalText),I(Object(f.a)(Object(f.a)(a)),"updateSettingsModal "+t);var n=a.state.settingsModalText.slice(0,a.state.settingsModalText.length);n.push(t),e?a.setState({showSettingsModal:e,settingsModalText:n}):(a.setState({settingsModalText:n}),a.timer=setInterval(a.updateSettingsTimeOut,5e3))},a.addTankCallBack=function(e){e?(a.updateSettingsModal(!0,"done."),0===a.state.simConfigurationIndex?a.configureThingDone():a.configureThing(a.setServerIp)):a.updateSettingsModal(!1,"Failed to add tank")},a.updateTankCallBack=function(e){e?(a.updateSettingsModal(!0,"Updating Tank DB...Done"),a.samplingIntervalChanged?a.configureThing(a.setInterval):a.updateSettingsModal(!1,"Setting thing done.")):a.updateSettingsModal(!1,"Fail to update tank")},a.liquidSelected=function(e){var t=N[e];a.setState({liquid_type:t})},a.renderIccdAndPhone=function(){return 1===a.state.simConfigurationIndex?r.a.createElement("div",null,r.a.createElement(ot.a,null,"Tank ICCID"),!a.props.tank&&r.a.createElement("div",null,r.a.createElement(fe.a,{type:"text",placeholder:a.iccidPh,onChange:function(e){return a.setState({iccid:e.target.value})}})),a.props.tank&&r.a.createElement("p",null," ",a.props.tank.iccid),r.a.createElement(ot.a,null,"Phone number"),r.a.createElement(fe.a,{type:"text",placeholder:a.phoneNumberPh,onChange:function(e){return a.setState({phone:e.target.value})}})):null},a.switchSimConfig=function(){a.setState({simConfigurationIndex:0===a.state.simConfigurationIndex?1:0})},a.getToken=function(e){E.a.post("https://console.monogoto.io/Auth",{UserName:"guy@orbitmonitoring.com",Password:"mono123!"}).then(function(t){I(Object(f.a)(Object(f.a)(a)),"getToken succedded"),a.updateSettingsModal(!0,"done."),a.token=t.data.token,e&&e()}).catch(function(e){I(Object(f.a)(Object(f.a)(a)),e),a.updateSettingsModal(!1,"Error on getting token")})},a.sendSemsToThing=function(e,t){var n={headers:{Authorization:"Bearer "+a.token}},r={Message:e,From:a.state.phone},s="https://console.monogoto.io/thing/ThingId_ICCID_"+a.state.iccid+"/sms";I(Object(f.a)(Object(f.a)(a)),"Sending thing API - "+r.Message+" "+r.From),E.a.post(s,r,n).then(function(e){I(Object(f.a)(Object(f.a)(a)),"testApi succedded"),a.updateSettingsModal(!0,"done."),t&&t()}).catch(function(e){I(Object(f.a)(Object(f.a)(a)),e),a.updateSettingsModal(!1,"error on configure Modem")})},a.configureThing=function(e){I(Object(f.a)(Object(f.a)(a)),"configureThing"),a.updateSettingsModal(!0,"getting token..."),a.getToken(e)},a.setServerIp=function(){I(Object(f.a)(Object(f.a)(a)),"setServerIp"),a.updateSettingsModal(!0,"Setting server IP..."),a.sendSemsToThing("pw123456,server=18.214.154.46,5005",a.setServerIpDone)},a.setServerIpDone=function(){I(Object(f.a)(Object(f.a)(a)),"setServerIpDone"),a.nextFunction=a.setProtocol,a.timer=setInterval(a.smsTimeOut,15e3)},a.setProtocol=function(){a.updateSettingsModal(!0,"Setting protocol..."),a.sendSemsToThing("pw123456,protocol=udp",a.setProtocolDone)},a.setProtocolDone=function(){I(Object(f.a)(Object(f.a)(a)),"setProtocolDone"),a.nextFunction=a.setInterval,a.timer=setInterval(a.smsTimeOut,15e3)},a.setInterval=function(){I(Object(f.a)(Object(f.a)(a)),"setInterval"),a.updateSettingsModal(!0,"Setting interval..."),a.sendSemsToThing("pw123456,interval="+a.state.sampling_interval+"s,"+a.state.sampling_interval+"s,0m,0d",a.configureThingDone)},a.configureThingDone=function(){I(Object(f.a)(Object(f.a)(a)),"configureThingDone"),a.updateSettingsModal(!1,"Setting thing done.")},a.smsTimeOut=function(){clearInterval(a.timer),a.nextFunction&&a.nextFunction()},a.updateData=function(){if(a.props.tank){var e=0;if(a.props.tank){for(var t in a.imeiPh=a.props.tank.imei,a.iccidPh=a.props.tank.iccid,a.phoneNumberPh=a.props.tank.phone,a.namePh=a.props.tank.name,a.buildingPh=a.props.tank.building,a.capacityPh=a.props.tank.capacity,a.highPh=a.props.tank.high,a.sampleIntervalPh=a.props.tank.sampling_interval,N)if(N[t]===a.props.tank.liquid_type){e=parseInt(t,10);break}a.setState({imei:a.imeiPh,phone:a.phoneNumberPh,name:a.namePh,building:a.buildingPh,capacity:a.capacityPh,high:a.highPh,iccid:a.iccidPh,sampling_interval:a.sampleIntervalPh,liquid_type:N[e]})}}clearInterval(a.timer)},a.state={imei:"",phone:"0000",name:"",building:"",liquid_type:N[0],capacity:0,high:0,iccid:"12345",sampling_interval:0,heartbeat_timeout:36e5,showSettingsModal:!1,settingsModalText:[],level_alerts:[],simConfigurationIndex:0},a.message=null,a.imeiPh="Tank ID (IMEI)",a.iccidPh="Thing ICCID",a.phoneNumberPh="Tank Phone number",a.namePh="Tank Name",a.buildingPh="Building Name",a.capacityPh="Capacity",a.highPh="Hight",a.sampleIntervalPh="Sample Interval",a.runTimer=!0,a.simConfigurationTitle=["Configuring Local SIM ","Configuring Monogoto SIM "],a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"validateForm",value:function(){return 15!==this.state.imei.length&&16!==this.state.imei.length?"Invalid IMEI - length must be 15 or 16 current length is "+this.state.imei.length:1===this.state.simConfigurationIndex&&this.state.iccid.length<5?"Invalid iccid length, current length "+this.state.iccid.length:this.state.sampling_interval<60?"Invalid Sampling Interval - value is less the 60 seconds":""===this.state.name?"Invalid tank name - name can't be empty":0===this.state.capacity?"Invalid tank capacity - capacity can't be 0":0===this.state.high?"Invalid tank high - high can't be 0":null}},{key:"addNewTank",value:function(){I(this,"addNewTank");var e=this.validateForm();e?alert(e):((new Q).addTank(this.addTankCallBack,this.state,this.props.customer.id),this.updateSettingsModal(!0,"Adding Tank to DB..."))}},{key:"updateTank",value:function(){I(this,"updateTank ");var e=this.validateForm();e?alert(e):((new Q).updateTank(this.updateTankCallBack,this.state,this.props.customer.id),this.updateSettingsModal(!0,"Updating Tank DB..."))}},{key:"renderTankFileds",value:function(){var e=this;return null===this.props.customer?null:r.a.createElement(lt.a,{controlId:"formBasicText"},r.a.createElement(ot.a,null,"Tank ID (IMEI)"),!this.props.tank&&r.a.createElement("div",null,r.a.createElement(fe.a,{type:"text",placeholder:this.imeiPh,onChange:function(t){return e.setState({imei:t.target.value})}})),this.props.tank&&r.a.createElement("p",null," ",this.props.tank.imei),this.renderIccdAndPhone(),r.a.createElement(ot.a,null,"Tank Name"),r.a.createElement(fe.a,{type:"text",placeholder:this.namePh,onChange:function(t){return e.setState({name:t.target.value})}}),r.a.createElement(ot.a,null,"Building Name"),r.a.createElement(fe.a,{type:"text",placeholder:this.buildingPh,onChange:function(t){return e.setState({building:t.target.value})}}),r.a.createElement(ot.a,null,"Tank Capacity (in liters)"),r.a.createElement(fe.a,{type:"text",placeholder:this.capacityPh,onChange:function(t){return e.setState({capacity:parseInt(t.target.value,10)})}}),r.a.createElement(ot.a,null,"Tank Hight (cm)"),r.a.createElement(fe.a,{type:"text",placeholder:this.highPh,onChange:function(t){return e.setState({high:parseFloat(t.target.value,10)})}}),r.a.createElement(ot.a,null,"Sample Interval (in second, min 60)"),r.a.createElement(fe.a,{type:"text",placeholder:this.sampleIntervalPh,onChange:function(t){e.setState({sampling_interval:parseInt(t.target.value,10)}),e.samplingIntervalChanged=!0}}),r.a.createElement("div",null),r.a.createElement(ot.a,{style:this.style},P("liquid")),r.a.createElement("br",null),r.a.createElement(Ae.a,{title:P(this.state.liquid_type),id:"liquidType"},N.map(function(t,a){return r.a.createElement(De.a,{eventKey:a,key:a,onSelect:e.liquidSelected},P(t))})))}},{key:"renderFormTitle",value:function(){if(this.props.customer){var e="Adding new tank to - "+this.props.customer.name;return this.props.tank?"Updating Tank - "+this.props.tank.name:r.a.createElement("div",null,r.a.createElement("div",null,e),r.a.createElement("div",null,this.simConfigurationTitle[this.state.simConfigurationIndex],r.a.createElement(Te.a,{onClick:this.switchSimConfig},"Switch")))}return""}},{key:"render",value:function(){var e=this;return I(this,"render"),!0===this.props.show?this.runTimer&&(this.timer=setInterval(this.updateData,1e3),this.runTimer=!1,this.samplingIntervalChanged=!1):this.runTimer=!0,r.a.createElement(Ce.a,Object.assign({},this.props,{bsSize:"lg","aria-labelledby":"contained-modal-title-sm"}),r.a.createElement(Ce.a.Header,{closeButton:!0},r.a.createElement(Ce.a.Title,{id:"contained-modal-title-sm"},this.renderFormTitle())),r.a.createElement(Ce.a.Body,null,r.a.createElement("form",null,this.renderTankFileds())),r.a.createElement(Ce.a.Footer,null,r.a.createElement(Te.a,{bsStyle:"warning",onClick:this.props.onHide},"Cancel"),this.props.tank&&r.a.createElement(Te.a,{bsStyle:"success",onClick:function(){return e.updateTank()}},"Update"),!this.props.tank&&r.a.createElement(Te.a,{bsStyle:"success",onClick:function(){return e.addNewTank()}},"Add")),r.a.createElement(dt,{show:this.state.showSettingsModal,title:"Setting Tank",text:this.state.settingsModalText}))}}]),t}(r.a.Component),pt=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).customerInfoReady=function(){I(Object(f.a)(Object(f.a)(a)),"customerInfoReady"),a.setState({customers:(new oe).getCustomers()})},a.readTanks=function(){(new Q).start(null,!0)},a.operationCallBack=function(){a.readCustomers()},a.editCustomer=function(e){a.setState({showCustomersModal:!0,selectedCustomer:e})},a.getFilteredCustomers=function(){if(0===a.state.customers.length||0===a.state.filterStr.length)return a.state.customers;for(var e=Object(Ue.a)(a.state.customers),t=e.length-1;t>=0;t--){-1===e[t].name.search(a.state.filterStr)&&e.splice(t,1)}return e},a.state={customers:[],showCustomersModal:!1,showTankForm:!1,showUsersModal:!1,selectedCustomer:null,filterStr:""};return a.buttonStyle={borderColor:"#3472F7",color:"#3472F7",whiteSpace:"normal",margin:"3px"},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.readCustomers()}},{key:"readCustomers",value:function(){(new oe).start(this.customerInfoReady,!0)}},{key:"closeCustomersModal",value:function(){this.readCustomers(),this.setState({showCustomersModal:!1,selectedCustomer:null})}},{key:"closeUsersModal",value:function(){this.setState({showUsersModal:!1,selectedCustomer:null})}},{key:"closeTankForm",value:function(){this.readTanks(),this.setState({showTankForm:!1,selectedCustomer:null})}},{key:"deleteCustomer",value:function(e){var t="Deleting Customrt: Are you sure you want to delete "+e.name+" ?";window.confirm(t)&&(I(this,"deleteCustomer "+e.name),(new oe).deleteCustomer(e.id,this.operationCallBack))}},{key:"addUser",value:function(e){this.setState({showUsersModal:!0,selectedCustomer:e})}},{key:"addTank",value:function(e){this.setState({showTankForm:!0,selectedCustomer:e})}},{key:"renderManageCustomersButton",value:function(e,t){var a=this;return r.a.createElement(Ae.a,{bsStyle:"primary",style:this.buttonStyle,bsSize:"large",title:"Settings",key:t,id:"dropdown-basic-".concat(t)},r.a.createElement(De.a,{eventKey:"1",style:this.buttonStyle,onClick:function(){return a.addUser(e)}},"Add User"),r.a.createElement(De.a,{eventKey:"2",onClick:function(){return a.addTank(e)}},"Add Tank"),r.a.createElement(De.a,{eventKey:"3",onClick:function(){return a.editCustomer(e)}},"Edit Customer"),r.a.createElement(De.a,{divider:!0}),r.a.createElement(De.a,{eventKey:"4",onClick:function(){return a.deleteCustomer(e)}},"Delete Customer"))}},{key:"renderFilterCard",value:function(){var e=this;return!1===(new A).isAdmin()?null:r.a.createElement(V.a,{xs:6},r.a.createElement(Y,{id:"filterCustomers",title:"Filter Customers",hCenter:!0,content:r.a.createElement("form",null,r.a.createElement(lt.a,{controlId:"formBasicText"},r.a.createElement(fe.a,{type:"text",value:this.state.value,placeholder:"Customer Name",onChange:function(t){return e.setState({filterStr:t.target.value})}})))}))}},{key:"renderCustomers",value:function(){var e=this;return this.getFilteredCustomers().map(function(t,a){return r.a.createElement(V.a,{xs:6,md:3,key:a},r.a.createElement(Y,{hCenter:!0,statsIcon:"fa",id:"ManageCustomer",title:r.a.createElement("div",null,r.a.createElement("div",null,t.name)),category:r.a.createElement("object",null,P("industry"),r.a.createElement("br",null),t.industry),stats:null,content:r.a.createElement("center",null,e.renderManageCustomersButton(t,a))}))})}},{key:"renderAddCustomrtButton",value:function(){var e=this;return r.a.createElement("center",null,r.a.createElement(Te.a,{bsSize:"large",bsStyle:"primary",style:this.buttonStyle,className:"pe-7s-add-user",onClick:function(){return e.setState({showCustomersModal:!0,customer:null})}}," ","Add New Customer"))}},{key:"render",value:function(){var e=this;return(new A).isAdmin()?r.a.createElement("div",{className:"content"},r.a.createElement(K.a,{fluid:!0},r.a.createElement(G.a,null,this.renderFilterCard()),r.a.createElement(G.a,null,r.a.createElement(V.a,{xs:12},r.a.createElement(Y,{hCenter:!0,statsIcon:"fa",id:"addCustomer",title:"New Customer",category:"",stats:null,content:this.renderAddCustomrtButton()}))),r.a.createElement(G.a,null,this.renderCustomers())),r.a.createElement(ct,{show:this.state.showCustomersModal,customer:this.state.selectedCustomer,onHide:function(){return e.closeCustomersModal()}}),r.a.createElement(ut,{show:this.state.showUsersModal,customer:this.state.selectedCustomer,onHide:function(){return e.closeUsersModal()}}),r.a.createElement(mt,{show:this.state.showTankForm,onHide:function(){return e.closeTankForm()},customer:this.state.selectedCustomer})):null}}]),t}(r.a.Component),ht=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).addAlert=function(){var e=a.validate();if("ok"===e){a.setState({statusMessage:""});for(var t=0,n=1;n<2e3;n++){for(var r in a.props.level_alerts)if(a.props.level_alerts[r].alert===n)break;t=n}var s={alert:t,at_level:a.state.at_level,mail:{subject:a.state.subject,body:a.state.body}};a.props.tank.level_alerts.push(s),a.setState({numberOfAlerts:a.props.tank.level_alerts.length}),a.updateAlerts()}else a.setState({statusMessage:e})},a.delete=function(e){a.props.tank.level_alerts.splice(e,1),a.setState({numberOfAlerts:a.props.tank.level_alerts.length}),a.updateAlerts()},a.renderAlerts=function(){return r.a.createElement("div",null,a.props.tank.level_alerts.length>0&&r.a.createElement(ot.a,null,"Alerts"),a.props.tank.level_alerts.map(function(e,t){return r.a.createElement("div",null,"Level - ",e.at_level,"% Subject - ",e.mail.subject," Body - ",e.mail.body,r.a.createElement(Te.a,{bsStyle:"warning",style:{margin:"3px"},value:t,onClick:function(e){return a.delete(e.target.value)}},"Delete"))}),a.props.tank.level_alerts.length>0&&r.a.createElement("hr",null))},a.validate=function(){if(a.state.at_level<0||a.state.at_level>100)return"invalid level - must be a number 0-100";for(var e in a.props.tank.level_alerts)if(a.props.tank.level_alerts[e].at_level===a.state.at_level)return"invalid level - tank allready has alert in level "+a.state.at_level+"%";return 0===a.state.body.length?"invalid body - body is empty":a.state.subject.length<2?"invalid subject - subject is empty":"ok"},a.updateAlerts=function(){var e=new Q,t=a.props.tank.customer;e.updateTank(a.updateAlertsCallBack,a.props.tank,t)},a.updateAlertsCallBack=function(e){e?a.setState({statusMessage:"Updating alerts succedded"}):a.setState({statusMessage:"Updating alerts failed"})},a.state={at_level:-1,alert:0,subject:"",body:"",numberOfAlerts:0,statusMessage:""},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"createForm",value:function(){var e=this;return r.a.createElement("form",null,r.a.createElement(lt.a,{controlId:"formBasicText"},r.a.createElement(ot.a,null,"Alert Level"),r.a.createElement(fe.a,{type:"text",placeholder:"Alert Level in %",onChange:function(t){return e.setState({at_level:parseInt(t.target.value,10),statusMessage:""})}}),r.a.createElement(ot.a,null,"Mail Subject"),r.a.createElement(fe.a,{type:"text",placeholder:"Mail Subject",onChange:function(t){return e.setState({subject:t.target.value,statusMessage:""})}}),r.a.createElement(ot.a,null,"Mail Body"),r.a.createElement(fe.a,{type:"text",placeholder:"Mail Body",onChange:function(t){return e.setState({body:t.target.value,statusMessage:""})}})),r.a.createElement(Te.a,{bsStyle:"success",style:{margin:"3px"},onClick:function(){return e.addAlert()}},"Add New Alert"),this.state.statusMessage)}},{key:"getFormTitle",value:function(){return this.props.tank?"Tanks Alerts - "+this.props.tank.name:""}},{key:"render",value:function(){return I(this,"render"),null===this.props.tank?null:r.a.createElement(Ce.a,Object.assign({},this.props,{bsSize:"lg","aria-labelledby":"contained-modal-title-sm"}),r.a.createElement(Ce.a.Header,{closeButton:!0},r.a.createElement(Ce.a.Title,{id:"contained-modal-title-sm"},this.getFormTitle())),r.a.createElement(Ce.a.Body,null,this.renderAlerts(),this.createForm()),r.a.createElement(Ce.a.Footer,null,r.a.createElement(Te.a,{bsStyle:"warning",onClick:this.props.onHide},"Done")))}}]),t}(r.a.Component),gt=function(e){function t(e){var a;Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentWillUnmount=function(){clearInterval(a.timer)},a.tick=function(){W()&&(a.tanksReady(),clearInterval(a.timer))},a.readTanks=function(){var e=!0;0===a.state.tanks.length&&(e=!1),(new Q).start(a.tanksReady,e)},a.tanksReady=function(){var e=new Q;a.setState({tanks:e.getTanks().sort(function(e,t){return e.name>t.name?1:-1})})},a.editAlert=function(e){a.setState({showAlerstForm:!0,tank:e})},a.closeAlertsForm=function(){a.setState({showAlerstForm:!1,tank:null,customer:null})},a.deleteTank=function(e){window.confirm("Deleting Tank: Are you sure you want to delete this tanks?")&&(new Q).deleteTank(e.imei,a.readTanks)},a.renderTanks=function(){return a.state.tanks.map(function(e,t){return ke(e,a.state.filterStr)?null:r.a.createElement(V.a,{xs:6,md:4,key:t},r.a.createElement(Y,{hCenter:!0,statsIcon:"fa",id:"EditTank",title:r.a.createElement("div",null,r.a.createElement("div",null,e.name)),category:"",stats:Ee(e,null),content:r.a.createElement("center",null,a.renderManageTankButton(e,t))}))})},a.state={showTankForm:!1,showAlerstForm:!1,filterStr:"",tank:null,customer:null,tanks:[]};return a.buttonStyle={borderColor:"#3472F7",color:"#3472F7",whiteSpace:"normal"},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.tick,250)}},{key:"closeTankForm",value:function(){this.setState({showTankForm:!1,tank:null,customer:null,tanks:[]}),(new Q).start(this.tanksReady,!0)}},{key:"editTank",value:function(e){var t=(new oe).getCustomer(e.customer);this.setState({showTankForm:!0,tank:e,customer:t})}},{key:"renderManageTankButton",value:function(e,t){var a=this,n=r.a.createElement("div",null,r.a.createElement("div",null,"Settings"));return r.a.createElement(Ae.a,{bsStyle:"primary",style:this.buttonStyle,bsSize:"large",title:n,key:t,id:"dropdown-basic-".concat(t)},r.a.createElement(De.a,{eventKey:"1",onClick:function(){return a.editTank(e)}},"Edit Tank"),r.a.createElement(De.a,{eventKey:"2",onClick:function(){return a.editAlert(e)}},"Edit Alerts"),r.a.createElement(De.a,{divider:!0}),r.a.createElement(De.a,{eventKey:"3",onClick:function(){return a.deleteTank(e)}},"Delete Tank"))}},{key:"render",value:function(){var e=this;return(new A).isAdmin()?r.a.createElement("div",{className:"content"},r.a.createElement(K.a,{fluid:!0},r.a.createElement(G.a,null,we(this)),r.a.createElement(G.a,null,this.renderTanks())),r.a.createElement(mt,{show:this.state.showTankForm,onHide:function(){return e.closeTankForm()},tank:this.state.tank,customer:this.state.customer}),r.a.createElement(ht,{show:this.state.showAlerstForm,tank:this.state.tank,onHide:function(){return e.closeAlertsForm()}})):null}}]),t}(r.a.Component),ft=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).usersReadyCallBack=function(){var e=new F;a.setState({users:e.getUsers()})},a.renderActions=function(e,t){return r.a.createElement(Ae.a,{bsStyle:"primary",bsSize:"large",className:"pe-7s-settings",title:" User Settings ",key:t,id:"dropdown-basic-".concat(t)},r.a.createElement(De.a,{eventKey:"1",onClick:function(){return a.deleteUser(e)}},"Delete User"))},a.isFiltered=function(e,t){return 0!==a.state.filterStr.length&&-1===e.name.search(a.state.filterStr)&&-1===t.search(a.state.filterStr)},a.state={users:[],filterStr:""},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){(new F).start(this.usersReadyCallBack,!0)}},{key:"deleteUser",value:function(e){var t="Deleting User: Are you sure you want to delete "+e.name+" ?";window.confirm(t)&&(new F).remove(e.name,this.usersReadyCallBack)}},{key:"renderUsers",value:function(){var e=this;return this.state.users.map(function(t,a){var n=(new oe).getCustomerName(t.customer_id);return e.isFiltered(t,n)?null:"admin"!==t.role.toLowerCase()?r.a.createElement(V.a,{xs:12,sm:6,key:a},r.a.createElement(Y,{hCenter:!0,statsIcon:"fa",id:"ManageUser",title:r.a.createElement("div",null,t.name),category:"",stats:"Customer - "+n,content:r.a.createElement("center",null,e.renderActions(t,a))})):null})}},{key:"renderFilterCard",value:function(){var e=this;return!1===(new A).isAdmin()?null:r.a.createElement(V.a,{md:4},r.a.createElement(Y,{id:"filterUsers",title:"Filter Users",hCenter:!0,content:r.a.createElement("form",null,r.a.createElement(lt.a,{controlId:"formBasicText"},r.a.createElement(fe.a,{type:"text",value:this.state.value,placeholder:"User / Customer",onChange:function(t){return e.setState({filterStr:t.target.value})}})))}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"content"},r.a.createElement(K.a,{fluid:!0},r.a.createElement(G.a,null,this.renderFilterCard()),r.a.createElement(G.a,null,this.renderUsers())))}}]),t}(r.a.Component),vt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).isAppReady=function(){W()&&a.setState({appIsredy:!0}),!1===a.state.showAlerstForm&&a.counter++%60===0&&a.setState({appIsredy:!1})},a.renderAlertsTanks=function(){return ve((new ne).getLevelMonitoring("name"))},a.showAlertsForm=function(e){a.setState({showAlerstForm:!0,tank:e})},a.closeAlertsForm=function(){a.setState({showAlerstForm:!1,tank:null,customer:null})},a.renderAlertsAndEdit=function(e){var t=new Z,n=t.getLevelNotificationsOnTank(e),s=t.getHeartBeatNotificationForTank(e),i=r.a.createElement("center",null,r.a.createElement(Te.a,{bsStyle:"danger",style:{margin:"3px",color:"#3472F7"},onClick:function(){return a.showAlertsForm(e)}},"Edit Alerts"));return 0===n.length&&0===s.length?r.a.createElement("div",null,r.a.createElement(re.a,{bsStyle:"info",className:"alert-with-icon"},r.a.createElement("center",null,r.a.createElement("span",{"data-notify":"icon",className:"pe-7s-bell"}),r.a.createElement("span",{"data-notify":"message"},"No Alerts On This Tank",r.a.createElement("q",null,alert.name)))),i):r.a.createElement("div",null,se(n),ie(s),i)},a.renderTanks=function(){return(new ne).getLevelMonitoring("name").map(function(e,t){var n=(new Q).getTank(e.imei);if(null===n)return null;var s=0!==(new Z).getLevelNotificationsOnTank(n).length;if(ke(n,a.state.filterStr))return null;var i=parseInt(n.capacity*e.actual_level/100,10)+" L";return r.a.createElement(V.a,{xs:12,md:4,key:t},r.a.createElement(Y,{hCenter:!0,statsIcon:"fa",id:"EditTank",title:r.a.createElement("div",null,r.a.createElement("div",null,n.name)),category:"",stats:a.renderAlertsAndEdit(n),content:r.a.createElement(he,{value:e.actual_level,height:"40%",volume:i,asAlerts:s})}))})},a.state={appIsredy:!1,showAlerstForm:!1,tank:null},a.counter=1,a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.timer=setInterval(this.isAppReady,1e3),this.isAppReady()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){var e=this;return!1===this.state.appIsredy?r.a.createElement(Y,{hCenter:!0,title:"Loading ...",content:r.a.createElement("center",null,r.a.createElement(Je,null))}):r.a.createElement("div",{className:"content"},r.a.createElement(K.a,{fluid:!0},r.a.createElement(G.a,null,we(this)),r.a.createElement(G.a,null,this.renderTanks())),r.a.createElement(ht,{show:this.state.showAlerstForm,tank:this.state.tank,onHide:function(){return e.closeAlertsForm()}}))}}]),t}(r.a.Component),kt=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,j.map(function(e,t){return r.a.createElement("div",{key:t},e)}))}}]),t}(r.a.Component),yt=a(268),bt=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"content"},r.a.createElement(K.a,{fluid:!0},r.a.createElement(G.a,null,r.a.createElement(V.a,{md:12},r.a.createElement($,{title:"202 Awesome Stroke Icons",ctAllIcons:!0,category:r.a.createElement("span",null,"Handcrafted by our friends from"," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"http://themes-pixeden.com/font-demos/7-stroke/index.html"},"Pixeden")),content:r.a.createElement(G.a,null,yt.iconsArray.map(function(e,t){return r.a.createElement(V.a,{lg:2,md:3,sm:4,xs:6,className:"font-icon-list",key:t},r.a.createElement("div",{className:"font-icon-detail"},r.a.createElement("i",{className:e}),r.a.createElement("input",{type:"text",defaultValue:e})))}))})))))}}]),t}(n.Component),Et=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){(new A).logOut(),window.location.reload()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(g.a,{to:"/dashboard"}))}}]),t}(r.a.Component),wt=[{path:"/dashboard",name:"Dashboard",icon:"pe-7s-graph",component:it},{path:"/graph",name:"Graph",icon:"pe-7s-graph1",component:Xe},{path:"/data",name:"Data",icon:"pe-7s-note2",component:Ze},{path:"/locations",name:"Locations",icon:"pe-7s-map-2",component:nt},{path:"/logout",name:"Log Out",icon:"pe-7s-power",component:Et},{path:"/customers",name:"Admin - Customers",icon:"pe-7s-users",component:pt,show:"admin"},{path:"/tanks",name:"Admin - Tanks",icon:"pe-7s-server",component:gt,show:"admin"},{path:"/users",name:"Admin - Users",icon:"pe-7s-users",component:ft,show:"admin"},{path:"/alerts",name:"Admin - Alerts",icon:"pe-7s-gleam",component:vt,show:"admin"},{path:"/logger",name:"Admin - logs",icon:"pe-7s-rocket",component:kt,show:"admin"},{path:"/icons",name:"Icons",icon:"pe-7s-science",component:bt,show:"admin"},{redirect:!0,path:"/",to:"/dashboard",name:"Dashboard"}],St=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).mobileSidebarToggle=a.mobileSidebarToggle.bind(Object(f.a)(Object(f.a)(a))),a.state={sidebarExists:!1},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"mobileSidebarToggle",value:function(e){!1===this.state.sidebarExists&&this.setState({sidebarExists:!0}),e.preventDefault(),document.documentElement.classList.toggle("nav-open")}},{key:"getBrand",value:function(){var e,t=this;return wt.map(function(a,n){return a.collapse?a.views.map(function(a,n){return a.path===t.props.location.pathname&&(e=a.name),null}):(a.redirect,a.path===t.props.location.pathname&&(e=a.name)),null}),e}},{key:"render",value:function(){return r.a.createElement(v.a,{fluid:!0,style:{backgroundColor:"#3472F7"}},r.a.createElement(v.a.Header,null,r.a.createElement(v.a.Brand,null,r.a.createElement("a",{href:"#pablo",style:{color:"white"}},this.getBrand())),r.a.createElement(v.a.Toggle,{onClick:this.mobileSidebarToggle})),r.a.createElement(v.a.Collapse,null,r.a.createElement(H,null)))}}]),t}(n.Component),Ct=a(810),Tt=a(269),Ot=a.n(Tt),xt=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentDidMount=function(){a.timer=setInterval(a.checkIfAppIsReady,1e3),a.checkIfAppIsReady()},a.componentWillUnmount=function(){clearInterval(a.timer)},a.checkIfAppIsReady=function(){W()&&(a.setState({appIsReady:!0}),clearInterval(a.timer))},a.state={width:window.innerWidth,appIsReady:!1},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"activeRoute",value:function(e){return this.props.location.pathname.indexOf(e)>-1?"active":""}},{key:"updateDimensions",value:function(){this.setState({width:window.innerWidth})}},{key:"componentDidMount",value:function(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions.bind(this))}},{key:"render",value:function(){var e=this,t=new A,a=t.isAdmin(),n=t.getLogedInUser();return r.a.createElement("div",{id:"sidebar",className:"sidebar","data-color":"blue"},r.a.createElement("div",{className:"sidebar-background"}),r.a.createElement("div",{className:"logo",style:{backgroundColor:"white"}},r.a.createElement("center",null,r.a.createElement("a",{href:"dashboard",className:"simple-text logo-mini"},r.a.createElement("div",{className:"logo-img"},r.a.createElement("img",{src:Ot.a,alt:"logo_image",style:{height:"130%",width:"130%"}}))),r.a.createElement("a",{href:"dashboard",className:"simple-text logo-normal",style:{color:"#3472F7"}},"ORBIT"))),r.a.createElement("div",{className:"sidebar-wrapper"},r.a.createElement("ul",{className:"nav"},wt.map(function(t,n){var s=!0;return(t.show&&"admin"===t.show&&!a||t.redirect&&!0===t.redirect)&&(s=!1),s?r.a.createElement("li",{className:t.upgrade?"active active-pro":e.activeRoute(t.path),key:n},r.a.createElement(Ct.a,{to:t.path,className:"nav-link",activeClassName:"active"},r.a.createElement("i",{className:t.icon,style:{display:"block",marginLeft:"auto",marginRight:"auto",width:"100%"}}),r.a.createElement("div",null,r.a.createElement("center",null,r.a.createElement("h4",null,t.name))))):null}),r.a.createElement("center",null,r.a.createElement("hr",null),r.a.createElement("div",{style:{color:"white"}},"SW Version 2.0"),r.a.createElement("br",null),r.a.createElement("div",{style:{color:"white"}},"User Name - ",n),r.a.createElement("hr",null)))))}}]),t}(n.Component),jt=a(219),It=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).usersTableReady=function(){a.setState({showButton:!0})},a.state={isLogIn:!1,showAlert:!1,showButton:!1},a.handleChange=a.handleChange.bind(Object(f.a)(Object(f.a)(a))),a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){(new A).isLogIn()&&this.setState({isLogIn:!0}),(new F).start(this.usersTableReady,!0)}},{key:"handleLogIn",value:function(){I(this,"handleLogIn"),I(this,this.state.userName),I(this,this.state.password);var e=(new F).getUser(this.state.userName),t=null;if(e){if(e.passwd===this.state.password)return(new y.a).set("user",this.state.userName),this.setState({isLogIn:!0,logInAlert:null}),void window.location.reload();t="the password for "+this.state.userName+" is incorrect"}else t=this.state.userName+" not found";this.setState({isLogIn:!1,logInAlert:t})}},{key:"handleChange",value:function(e){var t,a=e.target;this.setState((t={},Object(jt.a)(t,a.name,a.value),Object(jt.a)(t,"logInAlert",null),t))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,!1===this.state.isLogIn&&r.a.createElement(Ce.a,{show:!0,bsSize:"lg",onHide:this.handleHide,container:this,"aria-labelledby":"contained-modal-title"},r.a.createElement(Ce.a.Header,{closeButton:!0},r.a.createElement(Ce.a.Title,{id:"contained-modal-title"},"LogIn")),r.a.createElement(Ce.a.Body,null,"User Name:",r.a.createElement(fe.a,{type:"text",placeholder:"user name",onChange:this.handleChange,name:"userName"}),"Password:",r.a.createElement(fe.a,{type:"text",placeholder:"password",onChange:this.handleChange,name:"password"})),r.a.createElement(Ce.a.Footer,null,this.state.logInAlert&&r.a.createElement("center",null,"Failed to Login: ",this.state.logInAlert),this.state.showButton&&r.a.createElement(Te.a,{onClick:function(){return e.handleLogIn()}},"LogIn"))))}}]),t}(r.a.Component),Mt=[{path:"/",name:"Home",component:function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).componentDidMount=function(){(new F).start(a.userTableReady,!1)},a.userTableReady=function(){(new Q).start(a.tanksTableReady,!1)},a.tanksTableReady=function(){(new oe).start(a.customersTableReady,!1)},a.customersTableReady=function(){(new ne).getLastReading(a.allIsReady)},a.allIsReady=function(){var e=(new Q).getCustomerTanks((new A).getLoggedInCustomerId());e.length>0&&(qe(e[0]),Ve(e[0])),z=!0},a.dbReady=function(){a.setState({appDbReady:a.state.appDbReady+1})},a.state={_notificationSystem:null,appDbReady:0},a}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(e){window.innerWidth<993&&e.history.location.pathname!==e.location.pathname&&-1!==document.documentElement.className.indexOf("nav-open")&&document.documentElement.classList.toggle("nav-open"),"PUSH"===e.history.action&&(document.documentElement.scrollTop=0,document.scrollingElement.scrollTop=0,this.refs.mainPanel.scrollTop=0)}},{key:"render",value:function(){var e=this;return(new A).isLogIn()?r.a.createElement("div",{className:"wrapper"},r.a.createElement(xt,this.props),r.a.createElement("div",{id:"main-panel",className:"main-panel",ref:"mainPanel"},r.a.createElement(St,this.props),r.a.createElement(o.a,null,wt.map(function(t,a){return"Notifications"===t.name?r.a.createElement(c.a,{path:t.path,key:a,render:function(a){return r.a.createElement(t.component,Object.assign({},a,{handleClick:e.handleNotificationClick}))}}):t.redirect?r.a.createElement(g.a,{from:t.path,to:t.to,key:a}):r.a.createElement(c.a,{path:t.path,component:t.component,key:a})})))):r.a.createElement(It,null)}}]),t}(n.Component)}],Ft=(a(567),a(569),a(571),a(573),a(270)),At=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Dt(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(r.a.createElement(l.a,null,r.a.createElement(o.a,null,console.log("Version - "+Ft.version),Mt.map(function(e,t){return r.a.createElement(c.a,{to:e.path,component:e.component,key:t})}))),document.getElementById("root")),function(e){if(console.log("service worker - register 1"),"serviceWorker"in navigator){if(console.log("service worker - register 3"),new URL("",window.location.href).origin!==window.location.origin)return;console.log("service worker - register 3"),window.addEventListener("load",function(){var t="".concat("","/service-worker.js");console.log("service worker - befor isLocalhost"),At?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Dt(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Dt(t,e)})}}()}},[[272,6,2]]]);
//# sourceMappingURL=main.93b35bae.chunk.js.map